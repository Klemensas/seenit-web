(this["webpackJsonpseenit-web"]=this["webpackJsonpseenit-web"]||[]).push([[0],{152:function(e,t,n){e.exports=n.p+"static/media/chrome.fb7a4d16.svg"},153:function(e,t,n){e.exports=n.p+"static/media/vlc.78c4bd2f.svg"},198:function(e,t,n){e.exports=n(255)},203:function(e,t,n){},204:function(e,t,n){},255:function(e,t,n){"use strict";n.r(t);var a,r,i,l,c,o,s,d,m,u,v,p,f,E,g,h,b,w,y,I,O,k,x,j,T,C,S,N,A,R,$,D,L,_,M,P,W=n(23),q=n.n(W),F=n(33),z=n(0),Q=n.n(z),B=n(31),Y=n.n(B),G=n(6),H=n(19),V=(n(203),n(44)),U=(n(204),n(85)),Z=n(13);!function(e){e.Movie="Movie",e.Tv="Tv"}(_||(_={})),function(e){e.Season="Season",e.Episode="Episode"}(M||(M={})),function(e){e.Movie="Movie",e.Tv="Tv"}(P||(P={}));var J=Object(G.gql)(a||(a=Object(Z.a)(["\n  fragment ManagedSettings on Settings {\n    general {\n      autoConvert\n    }\n    extension {\n      autoTrack\n      minLengthSeconds\n      blacklist\n    }\n  }\n"]))),K=Object(G.gql)(r||(r=Object(Z.a)(["\n  fragment WatchedTvItemProps on TvItem {\n    ... on Episode {\n      id\n      episode_number\n      season {\n        id\n        season_number\n      }\n    }\n    ... on Season {\n      id\n      season_number\n    }\n  }\n"]))),X=Object(G.gql)(i||(i=Object(Z.a)(["\n  fragment WatchedProps on Watched {\n    id\n    createdAt\n    tvItemType\n    tvItem {\n      ...WatchedTvItemProps\n    }\n    rating {\n      id\n      value\n    }\n    review {\n      id\n      body\n    }\n    user {\n      id\n      name\n    }\n  }\n  ","\n"])),K),ee=Object(G.gql)(l||(l=Object(Z.a)(["\n  fragment WatchedCursorProps on WatchedCursor {\n    cursor\n    hasMore\n    watched {\n      ...WatchedProps\n    }\n  }\n  ","\n"])),X),te=Object(G.gql)(c||(c=Object(Z.a)(["\n  fragment ItemData on Item {\n    ... on Movie {\n      id\n      title\n      release_date\n      poster_path\n      backdrop_path\n    }\n    ... on Tv {\n      id\n      name\n      first_air_date\n      poster_path\n      backdrop_path\n    }\n  }\n"]))),ne=Object(G.gql)(o||(o=Object(Z.a)(["\n  fragment WatchedItemProps on Watched {\n    itemType\n    item {\n      ...ItemData\n    }\n  }\n  ","\n"])),te),ae=Object(G.gql)(s||(s=Object(Z.a)(["\n  fragment WatchedCursorWithItemsProps on WatchedCursor {\n    cursor\n    hasMore\n    watched {\n      ...WatchedProps\n      ...WatchedItemProps\n    }\n  }\n  ","\n  ","\n"])),X,ne),re=Object(G.gql)(d||(d=Object(Z.a)(["\n  fragment SeasonProps on Season {\n    id\n    name\n    overview\n    episode_count\n    air_date\n    poster_path\n    season_number\n    episodes {\n      id\n      name\n      overview\n      episode_number\n      air_date\n      vote_average\n      vote_count\n    }\n  }\n"]))),ie=Object(G.gql)(m||(m=Object(Z.a)(["\n  fragment SearchItemData on SearchItem {\n    id\n    tmdbId\n    title\n    release_date\n    poster_path\n    type\n  }\n"]))),le=Object(G.gql)(u||(u=Object(Z.a)(["\n  fragment WatchedImportData on WatchedImport {\n    tmdbId\n    itemId\n    itemType\n    tvItemId\n    tvItemType\n    createdAt\n    rating {\n      value\n    }\n    review {\n      body\n    }\n    itemType\n    item {\n      ...SearchItemData\n    }\n  }\n  ","\n"])),ie),ce=Object(G.gql)(v||(v=Object(Z.a)(["\n  mutation Login($email: String!, $password: String!) {\n    login(email: $email, password: $password) {\n      token\n      user {\n        id\n        name\n        email\n        createdAt\n        updatedAt\n        settings {\n          general {\n            autoConvert\n          }\n          extension {\n            autoTrack\n            minLengthSeconds\n            blacklist\n          }\n        }\n      }\n    }\n  }\n"])));var oe=Object(G.gql)(p||(p=Object(Z.a)(["\n  mutation Register($name: String!, $email: String!, $password: String!) {\n    register(name: $name, email: $email, password: $password) {\n      token\n      user {\n        id\n        name\n        email\n        createdAt\n        updatedAt\n        settings {\n          general {\n            autoConvert\n          }\n          extension {\n            autoTrack\n            minLengthSeconds\n            blacklist\n          }\n        }\n      }\n    }\n  }\n"])));var se=Object(G.gql)(f||(f=Object(Z.a)(["\n  mutation Logout {\n    logout @client\n  }\n"])));var de=Object(G.gql)(E||(E=Object(Z.a)(["\n  mutation AddWatched(\n    $itemId: ID!\n    $itemType: ItemType!\n    $createdAt: Float!\n    $rating: RatingInput\n    $review: ReviewInput\n    $tvItemId: ID\n    $tvItemType: TvItemType\n    $autoTrackedId: ID\n  ) {\n    addWatched(\n      itemId: $itemId\n      itemType: $itemType\n      createdAt: $createdAt\n      rating: $rating\n      review: $review\n      tvItemId: $tvItemId\n      tvItemType: $tvItemType\n      autoTrackedId: $autoTrackedId\n    ) {\n      id\n      itemType\n      createdAt\n      rating {\n        id\n        value\n      }\n      review {\n        id\n        body\n      }\n      tvItemType\n      tvItem {\n        ... on Episode {\n          id\n          episode_number\n          season {\n            id\n            season_number\n          }\n        }\n        ... on Season {\n          id\n          season_number\n        }\n      }\n    }\n  }\n"])));function me(e){return G.useMutation(de,e)}var ue=Object(G.gql)(g||(g=Object(Z.a)(["\n  mutation EditWatched(\n    $id: ID!\n    $createdAt: Float!\n    $rating: RatingInput\n    $review: ReviewInput\n    $tvItemId: ID\n    $tvItemType: TvItemType\n  ) {\n    editWatched(\n      id: $id\n      createdAt: $createdAt\n      rating: $rating\n      review: $review\n      tvItemId: $tvItemId\n      tvItemType: $tvItemType\n    ) {\n      id\n      itemType\n      createdAt\n      rating {\n        id\n        value\n      }\n      review {\n        id\n        body\n      }\n      tvItemType\n      tvItem {\n        ... on Episode {\n          id\n          episode_number\n          season {\n            id\n            season_number\n          }\n        }\n        ... on Season {\n          id\n          season_number\n        }\n      }\n    }\n  }\n"])));function ve(e){return G.useMutation(ue,e)}var pe=Object(G.gql)(h||(h=Object(Z.a)(["\n  mutation RemoveWatched($itemId: ID!) {\n    removeWatched(itemId: $itemId)\n  }\n"])));var fe=Object(G.gql)(b||(b=Object(Z.a)(["\n  mutation RemoveAutoTracked($ids: [ID!]!) {\n    removeAutoTracked(ids: $ids)\n  }\n"])));var Ee=Object(G.gql)(w||(w=Object(Z.a)(["\n  mutation ConvertAutoTracked($ids: [ID!]!) {\n    convertAutoTracked(ids: $ids) {\n      removedIds\n    }\n  }\n"])));var ge=Object(G.gql)(y||(y=Object(Z.a)(["\n  mutation UpdateSettings(\n    $general: GeneralSettingsInput!\n    $extension: ExtensionSettingsInput!\n  ) {\n    updateSettings(general: $general, extension: $extension) {\n      ...ManagedSettings\n    }\n  }\n  ","\n"])),J);var he=Object(G.gql)(I||(I=Object(Z.a)(["\n  query Auth {\n    auth @client {\n      id\n      name\n      email\n      createdAt\n      settings {\n        general {\n          autoConvert\n        }\n        extension {\n          autoTrack\n          minLengthSeconds\n          blacklist\n        }\n      }\n    }\n  }\n"])));function be(e){return G.useQuery(he,e)}var we=Object(G.gql)(O||(O=Object(Z.a)(["\n  query IsExtensionCheckDone {\n    isExtensionCheckDone @client\n  }\n"])));var ye=Object(G.gql)(k||(k=Object(Z.a)(["\n  query User($name: String, $id: ID, $cursor: String) {\n    user(name: $name, id: $id) {\n      id\n      name\n      createdAt\n      watched(cursor: $cursor) {\n        ...WatchedCursorWithItemsProps\n      }\n    }\n  }\n  ","\n"])),ae);function Ie(e){return G.useQuery(ye,e)}var Oe=Object(G.gql)(x||(x=Object(Z.a)(['\n  query Movie($id: ID, $cursor: String) {\n    movie(id: $id) {\n      id\n      title\n      overview\n      release_date\n      poster_path\n      backdrop_path\n      vote_average\n      vote_count\n      watched(cursor: $cursor, filter: "Reviewed") {\n        ...WatchedCursorProps\n      }\n    }\n  }\n  ',"\n"])),ee);function ke(e){return G.useQuery(Oe,e)}var xe=Object(G.gql)(j||(j=Object(Z.a)(['\n  query Tv($id: ID, $cursor: String) {\n    tv(id: $id) {\n      id\n      name\n      overview\n      first_air_date\n      poster_path\n      backdrop_path\n      vote_average\n      vote_count\n      seasons {\n        ...SeasonProps\n      }\n      watched(cursor: $cursor, filter: "Reviewed") {\n        ...WatchedCursorProps\n      }\n    }\n  }\n  ',"\n  ","\n"])),re,ee);function je(e){return G.useQuery(xe,e)}var Te=Object(G.gql)(T||(T=Object(Z.a)(["\n  query Watched($id: ID!) {\n    watched(id: $id) {\n      ...WatchedProps\n      ...WatchedItemProps\n    }\n  }\n  ","\n  ","\n"])),X,ne);var Ce=Object(G.gql)(C||(C=Object(Z.a)(["\n  query Watches(\n    $userId: ID\n    $itemId: ID\n    $itemType: ItemType\n    $cursor: String\n    $tvItemId: ID\n    $tvItemType: TvItemType\n  ) {\n    watches(\n      userId: $userId\n      itemId: $itemId\n      itemType: $itemType\n      cursor: $cursor\n      tvItemId: $tvItemId\n      tvItemType: $tvItemType\n    ) {\n      ...WatchedCursorWithItemsProps\n    }\n  }\n  ","\n"])),ae);function Se(e){return G.useQuery(Ce,e)}var Ne=Object(G.gql)(S||(S=Object(Z.a)(["\n  query Reviews(\n    $userId: ID\n    $itemId: ID\n    $itemType: ItemType\n    $cursor: String\n    $tvItemId: ID\n    $tvItemType: TvItemType\n  ) {\n    reviews(\n      userId: $userId\n      itemId: $itemId\n      itemType: $itemType\n      cursor: $cursor\n      tvItemId: $tvItemId\n      tvItemType: $tvItemType\n    ) {\n      cursor\n      hasMore\n      reviews {\n        id\n        body\n        watched {\n          id\n          createdAt\n          rating {\n            id\n            value\n          }\n          tvItemType\n          tvItem {\n            ...WatchedTvItemProps\n          }\n          user {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n  ","\n"])),K);var Ae=Object(G.gql)(N||(N=Object(Z.a)(["\n  query SearchContent($title: String!) {\n    searchContent(title: $title) {\n      ...SearchItemData\n    }\n  }\n  ","\n"])),ie);var Re=Object(G.gql)(A||(A=Object(Z.a)(["\n  query AutoTrackedList($userId: ID!, $cursor: String) {\n    autoTrackedList(userId: $userId, cursor: $cursor) {\n      cursor\n      hasMore\n      autoTracked {\n        id\n        itemType\n        item {\n          ...ItemData\n        }\n        tvItemType\n        tvItem {\n          ...WatchedTvItemProps\n        }\n        meta {\n          title\n          filename\n          url\n          provider\n          tvData {\n            season\n            episode\n          }\n        }\n        createdAt\n      }\n    }\n  }\n  ","\n  ","\n"])),te,K);var $e=Object(G.gql)(R||(R=Object(Z.a)(["\n  query AutoTracked($id: ID!) {\n    autoTracked(id: $id) {\n      id\n      itemType\n      item {\n        ...ItemData\n      }\n      tvItemType\n      tvItem {\n        ...WatchedTvItemProps\n      }\n      meta {\n        title\n        filename\n        url\n        provider\n        tvData {\n          season\n          episode\n        }\n      }\n      createdAt\n    }\n  }\n  ","\n  ","\n"])),te,K);var De=Object(G.gql)($||($=Object(Z.a)(["\n  query Seasons($itemId: ID!) {\n    seasons(itemId: $itemId) {\n      ...SeasonProps\n    }\n  }\n  ","\n"])),re);var Le=Object(G.gql)(D||(D=Object(Z.a)(["\n  query Settings {\n    settings {\n      ...ManagedSettings\n    }\n  }\n  ","\n"])),J);var _e=Object(G.gql)(L||(L=Object(Z.a)(["\n  query ImportLetterboxd($file: Upload!) {\n    importLetterboxd(file: $file) {\n      original {\n        date\n        name\n        year\n        watchedDate\n        rating\n        review\n      }\n      imported {\n        ...WatchedImportData\n      }\n    }\n  }\n  ","\n"])),le);var Me=["redirectTo","redirectComponent"];function Pe(e){var t=e.redirectTo,n=void 0===t?"/login":t,a=e.redirectComponent,r=Object(U.a)(e,Me),i=be().data;return(null===i||void 0===i?void 0:i.auth)?z.createElement(V.b,r):a?z.createElement(V.b,Object.assign({},r,{component:a})):z.createElement(V.a,{to:n})}var We=n(10),qe=n(259),Fe=n(27),ze=n(70),Qe=n(62),Be=["svgRef","title"];function Ye(){return(Ye=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Ge(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var He,Ve,Ue=Q.a.createElement("style",null,"tspan { white-space:pre }.shp0 { fill: #ffffff;stroke: #000000;stroke-width: 3 } .shp1 { fill: #000000 } .shp2 { fill: #ffffff } "),Ze=Q.a.createElement("path",{className:"shp0",d:"M14.5 2L14.5 2C21.41 2 27 7.59 27 14.5L27 33.5C27 40.41 21.41 46 14.5 46L14.5 46C7.59 46 2 40.41 2 33.5L2 14.5C2 7.59 7.59 2 14.5 2Z"}),Je=Q.a.createElement("path",{className:"shp0",d:"M41.5 2L41.5 2C48.41 2 54 7.59 54 14.5L54 33.5C54 40.41 48.41 46 41.5 46L41.5 46C34.59 46 29 40.41 29 33.5L29 14.5C29 7.59 34.59 2 41.5 2Z"}),Ke=Q.a.createElement("path",{className:"shp1",d:"M44 38C39.02 38 35 33.98 35 29C35 24.02 39.02 20 44 20C48.98 20 53 24.02 53 29C53 33.98 48.98 38 44 38Z"}),Xe=Q.a.createElement("path",{className:"shp2",d:"M40.5 28C39.12 28 38 26.88 38 25.5C38 24.12 39.12 23 40.5 23C41.88 23 43 24.12 43 25.5C43 26.88 41.88 28 40.5 28Z"}),et=Q.a.createElement("path",{className:"shp1",d:"M17 38C12.02 38 8 33.98 8 29C8 24.02 12.02 20 17 20C21.98 20 26 24.02 26 29C26 33.98 21.98 38 17 38Z"}),tt=Q.a.createElement("path",{className:"shp2",d:"M13.5 28C12.12 28 11 26.88 11 25.5C11 24.12 12.12 23 13.5 23C14.88 23 16 24.12 16 25.5C16 26.88 14.88 28 13.5 28Z"}),nt=function(e){var t=e.svgRef,n=e.title,a=Ge(e,Be);return Q.a.createElement("svg",Ye({viewBox:"0 0 56 48",ref:t},a),n?Q.a.createElement("title",null,n):null,Ue,Ze,Je,Ke,Xe,et,tt)},at=Q.a.forwardRef((function(e,t){return Q.a.createElement(nt,Ye({svgRef:t},e))}));n.p;!function(e){e[e.text=0]="text",e[e.textLarge=1]="textLarge",e[e.logo=2]="logo",e[e.large=3]="large"}(Ve||(Ve={}));var rt=(He={},Object(Qe.a)(He,Ve.text,[14,12,"0 1px"]),Object(Qe.a)(He,Ve.textLarge,[16,14,"1px 1px 0 2px"]),Object(Qe.a)(He,Ve.logo,[18,16,"1px 1px 0"]),Object(Qe.a)(He,Ve.large,[24,19,"1px 1px 0 2px"]),He);function it(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{size:Ve.logo},t=e.size,n=Object(We.a)(rt[t],3),a=n[0],r=n[1],i=n[2];return Q.a.createElement("div",{className:"seenit-logo",style:{fontSize:a}},"S",Q.a.createElement(at,{className:"logo-eyes",style:{height:r,padding:i}}),"N\xa0IT")}it.defaultProps={size:Ve.logo};var lt=n(262),ct=n(26);var ot=function(e,t){var n=e.label,a=e.item,r=t.handleClick,i=t.modifiers;return i.matchesPredicate?z.createElement(qe.u,{active:i.active,key:a.id,text:n,onClick:r}):null},st=function(e){e.selected;var t,n=e.setSelected,a=z.useState(""),r=Object(We.a)(a,2),i=r[0],l=r[1],c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,a=Object(z.useRef)(),r=Object(z.useRef)(e),i=Object(z.useRef)(n),l=Object(z.useRef)();r.current=e,i.current=n;var c=Object(z.useCallback)((function(){a.current&&clearTimeout(a.current),a.current=void 0}),[]),o=Object(z.useCallback)((function(){for(var e=arguments.length,n=new Array(e),c=0;c<e;c++)n[c]=arguments[c];var o;(l.current=n,a.current)||((null===(o=i.current)||void 0===o?void 0:o.leading)?(r.current.apply(r,Object(ct.a)(l.current)),a.current=setTimeout((function(){a.current=void 0}),t)):a.current=setTimeout((function(){r.current.apply(r,Object(ct.a)(l.current)),a.current=void 0}),t))}),[t]),s=Object(z.useCallback)((function(){a&&(r.current.apply(r,Object(ct.a)(l.current)),c())}),[c]);return Object(z.useEffect)((function(){return c}),[c]),{callback:o,cancel:c,callPending:s}}((function(e){return l(e)}),1e3).callback,o=i.length>2,s=(t={variables:{title:i},skip:i.length<3},G.useQuery(Ae,t)),d=s.data&&s.data.searchContent?s.data.searchContent.reduce((function(e,t){return e.concat({label:"".concat(t.title," (").concat((t.release_date||"?").split("-")[0],")"),value:t.id,item:t})}),[]):[];return z.createElement(lt.a,{itemRenderer:ot,items:d,onQueryChange:c,onItemSelect:function(e){var t=e.item;return n(t)},noResults:z.createElement(qe.u,{disabled:!0,text:o?s.loading?"Loading...":"Got nothing :(":"Type more to start seach"}),initialContent:z.createElement(qe.u,{disabled:!0,text:"Type more to start seach"}),inputValueRenderer:function(e){return e.label},popoverProps:{minimal:!0,fill:!0,usePortal:!1,position:qe.A.BOTTOM},inputProps:{rightElement:(null===s||void 0===s?void 0:s.loading)?z.createElement(qe.B,{size:16}):void 0},className:"select-popover-centered"})};function dt(){var e=Object(V.g)();return z.createElement(st,{setSelected:function(t){var n=t.type,a=t.id;e.push("/".concat(null===n||void 0===n?void 0:n.toLowerCase(),"/").concat(a))}})}var mt=st;function ut(){var e,t=G.useMutation(se,e),n=Object(We.a)(t,1)[0],a=be().data;return(null===a||void 0===a?void 0:a.auth)?Q.a.createElement(qe.y,{content:Q.a.createElement(qe.s,null,Q.a.createElement(H.b,{to:"/profile/".concat(a.auth.name)},Q.a.createElement(qe.u,{tagName:"span",text:"Profile"})),Q.a.createElement(H.b,{to:"/settings"},Q.a.createElement(qe.a,{minimal:!0},"Settings")),Q.a.createElement(qe.u,{tagName:"span",text:"Logout",onClick:function(){return n()}})),position:Fe.a.BOTTOM},a.auth.name):Q.a.createElement(H.b,{to:"/login"},Q.a.createElement(qe.a,{minimal:!0,icon:"user"},"Login"))}function vt(){return Q.a.createElement("div",{className:"navigation-container"},Q.a.createElement(qe.v,{fixedToTop:!0},Q.a.createElement(qe.v.Group,{align:ze.a.LEFT},Q.a.createElement(qe.v.Heading,null,Q.a.createElement(H.c,{to:"/"},Q.a.createElement(it,null))),Q.a.createElement(qe.v.Divider,null)),Q.a.createElement(qe.v.Group,{align:ze.a.RIGHT},Q.a.createElement(dt,null),Q.a.createElement(qe.v.Divider,null),Q.a.createElement(ut,null))))}var pt,ft=n(16),Et=n(57);function gt(e){var t=window.localStorage.getItem("seenit-web-"+e);if(!t)return null;try{return JSON.parse(t)}catch(n){return t}}function ht(e,t){return t?window.localStorage.setItem("seenit-web-"+e,"string"===typeof t?t:JSON.stringify(t)):window.localStorage.removeItem("seenit-web-"+e)}var bt=function(e,t,n){ht("token",n||null),ht("userData",t||null),e.writeQuery({query:Object(G.gql)(pt||(pt=Object(Z.a)(["\n      {\n        auth\n      }\n    "]))),data:{auth:t||null}})};function wt(){var e,t=Object(V.g)(),n=Q.a.useState({email:"",password:"",name:""}),a=Object(We.a)(n,2),r=a[0],i=a[1],l=Q.a.useState(!0),c=Object(We.a)(l,2),o=c[0],s=c[1],d={variables:r,update:function(e,t){var n=t.data;if(n){var a="login"in n?n.login:n.register,r=a.token,i=a.user;bt(e,i,r),document.dispatchEvent(new CustomEvent("seenit-login"))}}},m=(e=d,G.useMutation(ce,e)),u=Object(We.a)(m,1)[0],v=function(e){return G.useMutation(oe,e)}(d),p=Object(We.a)(v,1)[0],f=o?u:p;return Q.a.createElement("form",{onSubmit:function(){var e=Object(F.a)(q.a.mark((function e(n){return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,f();case 3:t.push("/");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},!o&&Q.a.createElement(qe.k,{label:"Name",labelFor:"name-input"},Q.a.createElement(qe.r,{id:"name-input",large:!0,leftIcon:"user",onChange:function(e){return i(Object(ft.a)(Object(ft.a)({},r),{},{name:e.target.value}))},placeholder:"John Doe",value:r.name})),Q.a.createElement(qe.k,{label:"Email",labelFor:"email-input"},Q.a.createElement(qe.r,{id:"email-input",large:!0,type:"email",leftIcon:"envelope",onChange:function(e){return i(Object(ft.a)(Object(ft.a)({},r),{},{email:e.target.value}))},placeholder:"you@mail.com",value:r.email})),Q.a.createElement(qe.k,{label:"Password",labelFor:"password-input"},Q.a.createElement(qe.r,{id:"password-input",large:!0,type:"password",leftIcon:"lock",onChange:function(e){return i(Object(ft.a)(Object(ft.a)({},r),{},{password:e.target.value}))},placeholder:"Your password",value:r.password})),Q.a.createElement("div",{className:"flex flex-between"},Q.a.createElement(qe.a,{type:"submit",intent:Et.a.PRIMARY},o?"Login":"Register"),Q.a.createElement(qe.a,{type:"button",onClick:function(){return s(!o)}},o?"Need to create an account?":"Already have an account?")))}var yt=n(152),It=n.n(yt),Ot=n(153),kt=n.n(Ot);function xt(){return Q.a.createElement("div",{className:"hero-box"},Q.a.createElement(qe.l,null,"Automatically track what you've watched"),Q.a.createElement(qe.m,{className:"pt-3"},"Start tracking"),Q.a.createElement("div",{className:"py-4"},Q.a.createElement(qe.a,{large:!0,fill:!0,className:"my-4"},Q.a.createElement(H.b,{to:"/login"},"Join seen it")),Q.a.createElement(qe.a,{large:!0,fill:!0,className:"my-4"},Q.a.createElement(H.b,{to:"/setup"},"Download for your used platforms"))),Q.a.createElement("div",null,Q.a.createElement(qe.n,{className:"pb-2"},"Currently works with"),Q.a.createElement("div",null,Q.a.createElement("img",{className:"mx-3",style:{width:48},alt:"Chrome",src:It.a}),Q.a.createElement("img",{className:"mx-3",style:{height:48},alt:"VLC",src:kt.a}))))}var jt,Tt=n(154),Ct=n(58),St=n(263),Nt=n(90);function At(e){var t=e.value,n=e.className,a=void 0===n?"":n,r=e.max,i=void 0===r?10:r,l=e.size,c=t/(i/5),o=l===jt.Small?12:void 0;return Q.a.createElement(Nt.a,{readonly:!0,className:"rating rating-".concat(l)+a,initialRating:c,fractions:2,fullSymbol:Q.a.createElement(qe.p,{icon:Ct.a.STAR,iconSize:o,color:"gold"}),emptySymbol:Q.a.createElement(qe.p,{icon:Ct.a.STAR_EMPTY,iconSize:o,color:"gold"})})}function Rt(e){var t=e.children,n=e.loadMore,a=e.loading,r=e.hasMore,i=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"200px",r=Object(z.useRef)(null);return Object(z.useEffect)((function(){var i=new IntersectionObserver((function(a){Object(We.a)(a,1)[0].isIntersecting&&!t&&n&&e()}),{rootMargin:a});return r&&r.current&&i.observe(r.current),function(){return i.disconnect()}}),[t,e,a,n]),r}(n,a,r);return Q.a.createElement(Q.a.Fragment,null,t,!a&&r&&Q.a.createElement("div",{ref:i},"a"))}function $t(e){return e?"season_number"in e?"S".concat(e.season_number):"S".concat(e.season.season_number,"E").concat(e.episode_number):null}!function(e){e.Small="small"}(jt||(jt={}));var Dt=function(e,t){return function(){return e({variables:t,updateQuery:function(e,t){var n=t.fetchMoreResult;if(!(null===n||void 0===n?void 0:n.user))return e;var a=e.user.watched.watched||[],r=n.user.watched.watched||[];return{user:Object(ft.a)(Object(ft.a)({},n.user),{},{watched:Object(ft.a)(Object(ft.a)({},n.user.watched),{},{watched:[].concat(Object(ct.a)(a),Object(ct.a)(r))})})}}})}};function Lt(){var e,t=Object(z.useState)({style:void 0,targetIndex:-1}),n=Object(We.a)(t,2),a=n[0],r=n[1],i=Object(V.i)().name,l=Object(V.g)(),c=Ie({variables:{name:i},notifyOnNetworkStatusChange:!0}),o=c.loading,s=c.data,d=c.fetchMore;if(!(null===s||void 0===s||null===(e=s.user)||void 0===e?void 0:e.watched))return null;var m=s.user.watched,u=m.hasMore,v=m.cursor,p=m.watched,f=p[a.targetIndex]||null;return Q.a.createElement(Rt,{loading:o,hasMore:u,loadMore:Dt(d,{name:i,cursor:v})},Q.a.createElement("div",{className:"grid grid-card"},p.map((function(e,t){var n,a=e.id,i=e.item,l=e.itemType,c=e.rating,o=e.review,s=e.tvItem,d=e.createdAt;return i?(n=l===_.Movie?i.title:i.name,Q.a.createElement(qe.d,{key:a,className:"card-watched",onClick:function(e){var n=e.currentTarget.getBoundingClientRect();r({style:{left:n.left,top:n.top,width:n.width,height:n.height,position:"fixed"},targetIndex:t})}},Q.a.createElement("div",null,Q.a.createElement("div",{style:{position:"relative"}},Q.a.createElement("img",{width:"300",height:"200",className:"img-responsive",src:"https://image.tmdb.org/t/p/w1280".concat(i.poster_path),style:{position:"relative"},alt:""})),Q.a.createElement("div",{className:"card-watched-footer"},c&&Q.a.createElement(At,{value:c.value}),o&&o.body&&Q.a.createElement(qe.p,{icon:Ct.a.COMMENT,color:"gold"})),Q.a.createElement("div",{className:"p-3 text-left title"},Q.a.createElement("div",{className:"flex flex-content-between flex-items-center"},Q.a.createElement("strong",{className:"bp3-text-large bp3-text-overflow-ellipsis pr-2"},n),Q.a.createElement("div",null,$t(s))),Q.a.createElement("p",{className:"bp3-text-small card-watched-muted"},Object(St.a)(d,Date.now(),{addSuffix:!0})))))):null})),f&&Q.a.createElement(Tt.Spring,{config:{velocity:120,friction:16,clamp:!0},from:a.style,to:{left:0,top:50,width:window.innerWidth,height:window.innerHeight},onRest:function(){return l.push("/movie/".concat(f.item.id,"/watched/").concat(f.id))}},(function(e){return Q.a.createElement("div",{style:e},Q.a.createElement("img",{width:"300",height:"200",className:"img-responsive",src:"https://image.tmdb.org/t/p/w1280".concat(f.item.poster_path),style:{position:"relative",maxHeight:300,objectFit:"cover"},alt:""}),Q.a.createElement("div",{style:{height:"100%",backgroundColor:"#0C1821"}}))}))))}function _t(){return Q.a.createElement("div",null,"Download and setup the platform")}var Mt=n(2),Pt=n(260);function Wt(e){var t=e.date,n=e.baseDate,a=void 0===n?Date.now():n,r=e.options,i=void 0===r?{addSuffix:!0}:r;return Q.a.createElement(qe.H,{content:Object(Pt.a)(t,"yyyy MMM dd, HH:mm")},Object(St.a)(t,a,i))}function qt(e){var t=e.type,n=e.item,a=e.date,r=e.tvItem,i="title"in n?n.title:n.name,l=t===_.Movie?"movie":"tv";return Q.a.createElement(H.b,{to:"/".concat(l,"/").concat(n.id)},Q.a.createElement(qe.d,{className:"card-watched"},Q.a.createElement("div",{style:{position:"relative"}},Q.a.createElement("img",{width:"300",height:"200",className:"img-responsive",src:"https://image.tmdb.org/t/p/w1280".concat(n.poster_path),alt:"".concat(i," poster")})),Q.a.createElement("div",{className:"p-3 text-left title"},Q.a.createElement("div",{className:"flex flex-content-between flex-items-center"},Q.a.createElement("strong",{className:"bp3-text-large bp3-text-overflow-ellipsis pr-2"},i),Q.a.createElement("div",null,$t(r))),a&&Q.a.createElement("p",{className:"bp3-text-small card-watched-muted"},Q.a.createElement(Wt,{date:a})))))}var Ft,zt,Qt=n(5),Bt=n.n(Qt),Yt=function(e){return function(t){t.stopPropagation(),null===e||void 0===e||e(t)}},Gt=function(){return Ft||(Ft=document.getElementById("app-main")||void 0)},Ht=["canEscapeKeyCancel","canOutsideClickCancel","confirmButtonText","cancelButtonText","onConfirm","onCancel","isLoading","className","intent","icon","children"];function Vt(e){var t=e.canEscapeKeyCancel,n=void 0!==t&&t,a=e.canOutsideClickCancel,r=void 0!==a&&a,i=e.confirmButtonText,l=void 0===i?"Ok":i,c=e.cancelButtonText,o=e.onConfirm,s=e.onCancel,d=e.isLoading,m=void 0!==d&&d,u=e.className,v=void 0===u?"":u,p=e.intent,f=e.icon,E=e.children,g=Object(U.a)(e,Ht);return Q.a.createElement(qe.h,Object.assign({},g,{portalContainer:Gt(),className:Bt()(Mt.a.ALERT,v),canEscapeKeyClose:n&&!m,canOutsideClickClose:r&&!m,onClose:s}),Q.a.createElement("div",{className:Mt.a.ALERT_BODY},Q.a.createElement(qe.p,{icon:f,iconSize:40,intent:p}),Q.a.createElement("div",{className:Mt.a.ALERT_CONTENTS},E)),Q.a.createElement("div",{className:Mt.a.ALERT_FOOTER},Q.a.createElement(qe.a,{intent:p,text:l,onClick:o,loading:m,disabled:m}),c&&Q.a.createElement(qe.a,{text:c,onClick:s,disabled:m})))}function Ut(e){var t=e.title,n=e.isOpen,a=e.isLoading,r=e.onCancel,i=e.onConfirm;return Q.a.createElement(Vt,{cancelButtonText:"Cancel",confirmButtonText:"Remove",icon:"trash",intent:Et.a.DANGER,isOpen:n||!1,isLoading:a,onCancel:r,onConfirm:i},t)}function Zt(e){var t=e.id,n=e.createdAt,a=e.meta,r=e.item,i=e.tvItem,l=e.isSelected,c=e.onSelect,o=e.onDeselect,s=e.onSave,d=e.onRemove,m=r?"title"in r?r.title:r.name:"",u=Object(V.h)(),v=new URLSearchParams(u.search);return v.set(zt.EditingAutoTracked,t),Q.a.createElement(qe.d,{className:"card-watched fill-container ".concat(l?"selected":""),elevation:l?4:void 0,onClick:l?o:c},r&&Q.a.createElement(Q.a.Fragment,null,Q.a.createElement("div",null,Q.a.createElement("img",{width:"300",height:"200",className:"img-responsive",src:"https://image.tmdb.org/t/p/w342".concat(r.poster_path),alt:"".concat(m," poster")})),Q.a.createElement("div",{className:"p-3 title"},Q.a.createElement("div",{className:"flex flex-content-between flex-items-center"},Q.a.createElement("strong",{className:"bp3-text-large bp3-text-overflow-ellipsis pr-2"},m),Q.a.createElement("div",null,$t(i))),n&&Q.a.createElement("p",{className:"bp3-text-small card-watched-muted"},Q.a.createElement(Wt,{date:n})))),!r&&Q.a.createElement(qe.w,{icon:"help",title:"Couldn't find item",description:Q.a.createElement("div",{className:"text-left px-2",style:{width:"100%"}},Q.a.createElement("div",{className:"mb-3"},Q.a.createElement("strong",null,"Here's what we know:")),Q.a.createElement("div",{className:"mb-1"},"Watched ",Q.a.createElement(Wt,{date:n})),a.title&&Q.a.createElement("div",{className:"mb-1"},Q.a.createElement("span",null,"Title read as "),Q.a.createElement(qe.f,null,a.title)," "),a.tvData&&Q.a.createElement("div",{className:"mb-1"},Q.a.createElement("span",null,"TV info - "),a.tvData.season&&Q.a.createElement("span",null,"S",a.tvData.season),a.tvData.episode&&Q.a.createElement("span",null,"E",a.tvData.episode)),a.provider&&Q.a.createElement("div",{className:"mb-1"},Q.a.createElement("span",null,"Tracked on ",a.provider,", from"),Q.a.createElement("br",null),a.url&&Q.a.createElement(qe.f,{className:"mt-1",style:{display:"inline-block",textOverflow:"ellipsis",whiteSpace:"nowrap",width:"100%",overflow:"hidden"}},a.url),a.filename&&Q.a.createElement(qe.f,{className:"mt-1",style:{display:"inline-block",textOverflow:"ellipsis",whiteSpace:"nowrap",width:"100%",overflow:"hidden"}},a.filename)))}),Q.a.createElement(qe.b,{fill:!0,minimal:!0,onClick:Yt()},r&&Q.a.createElement(qe.a,{disabled:!r,icon:"tick",onClick:s},"Save"),Q.a.createElement(H.b,{to:{search:v.toString()},replace:!0,className:"bp3-button"},Q.a.createElement(qe.p,{icon:"edit",className:"mr-2"}),Q.a.createElement("span",null,"Edit")),Q.a.createElement(qe.a,{icon:"trash",onClick:d},"Remove")))}!function(e){e.EditingAutoTracked="editing-auto-tracked",e.EditingWatched="editing-watched"}(zt||(zt={}));var Jt=qe.G.create({position:Fe.a.TOP_RIGHT});function Kt(){var e,t,n,a,r=be().data,i=null===r||void 0===r?void 0:r.auth,l=Se({variables:{userId:null===r||void 0===r||null===(e=r.auth)||void 0===e?void 0:e.id}}).data,c=(a={variables:{userId:(null===r||void 0===r||null===(t=r.auth)||void 0===t?void 0:t.id)||""}},G.useQuery(Re,a)).data,o=Ie({variables:{id:null===i||void 0===i?void 0:i.id}}).data,s=function(e){return G.useMutation(fe,e)}({refetchQueries:["AutoTrackedList"]}),d=Object(We.a)(s,2),m=d[0],u=d[1].loading,v=function(e){return G.useMutation(Ee,e)}({refetchQueries:["AutoTrackedList"]}),p=Object(We.a)(v,1)[0],f=Object(z.useState)([]),E=Object(We.a)(f,2),g=E[0],h=E[1],b=Object(z.useState)(),w=Object(We.a)(b,2),y=w[0],I=w[1];return i&&(null===o||void 0===o||null===(n=o.user)||void 0===n?void 0:n.watched)?Q.a.createElement(Q.a.Fragment,null,Q.a.createElement("div",null,Q.a.createElement("div",null,Q.a.createElement(qe.m,{className:"pt-4 px-2"},"Automatically tracked shows"),Q.a.createElement("div",{className:"p-2 flex flex-items-center flex-content-end sticky-below-header"},Q.a.createElement(qe.e,{className:"m-0 py-2",checked:g.length===(null===c||void 0===c?void 0:c.autoTrackedList.autoTracked.length),indeterminate:!!g.length&&g.length<((null===c||void 0===c?void 0:c.autoTrackedList.autoTracked.length)||0),label:g.length?"".concat(g.length," Selected"):"Select all",onChange:function(){return h(g.length===(null===c||void 0===c?void 0:c.autoTrackedList.autoTracked.length)?[]:(null===c||void 0===c?void 0:c.autoTrackedList.autoTracked.map((function(e){return e.id})))||[])}}),Q.a.createElement(qe.a,{small:!0,className:"ml-2",icon:"tick",disabled:!g.length,onClick:Object(F.a)(q.a.mark((function e(){var t,n;return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g.filter((function(e){var t=null===c||void 0===c?void 0:c.autoTrackedList.autoTracked.find((function(t){return t.id===e}));return t&&t.item})),n=t.length!==g.length,e.next=4,p({variables:{ids:t}});case 4:n&&Jt.show({message:"Couldn't save items without shows",intent:Et.a.WARNING}),h([]);case 6:case"end":return e.stop()}}),e)})))},"Save"),Q.a.createElement(qe.a,{small:!0,className:"ml-2",icon:"trash",disabled:!g.length,onClick:function(){return I({title:Q.a.createElement("p",null,"Are you sure you want to remove the selected items?"),onConfirm:function(){var e=Object(F.a)(q.a.mark((function e(){return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m({variables:{ids:g}});case 2:h([]),I(null);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()})}},"Remove")),Q.a.createElement("div",{className:"grid grid-card"},null===c||void 0===c?void 0:c.autoTrackedList.autoTracked.map((function(e,t,n){var a=e.id,r=e.createdAt,i=e.meta,l=e.item,c=e.tvItem;return Q.a.createElement("div",{key:a,className:Mt.a.INTENT_PRIMARY,style:{position:"relative"}},g.includes(a)&&Q.a.createElement(qe.p,{icon:"tick-circle",intent:Et.a.PRIMARY,iconSize:16,style:{position:"absolute",left:-8,top:-8,zIndex:1}}),Q.a.createElement(Zt,{id:a,createdAt:r,meta:i,item:l,tvItem:c,isSelected:g.includes(a),onSelect:function(){return h([].concat(Object(ct.a)(g),[a]))},onDeselect:function(){return h(g.filter((function(e){return e!==a})))},onSave:function(){return p({variables:{ids:[a]}})},onRemove:function(){return I({title:Q.a.createElement("p",null,"Are you sure you want to remove the tracked item?"),onConfirm:function(){var e=Object(F.a)(q.a.mark((function e(){return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m({variables:{ids:[a]}});case 2:I(null);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()})}}))})))),Q.a.createElement("div",{className:"p-4 pb-1"},Q.a.createElement(qe.m,null,"Your last seen")),Q.a.createElement("div",{className:"grid grid-card"},null===l||void 0===l?void 0:l.watches.watched.map((function(e){var t=e.id,n=e.itemType,a=e.item,r=e.createdAt,i=e.tvItem;return Q.a.createElement(qt,{key:t,type:n,item:a,tvItem:i||void 0,date:r})})))),y&&Q.a.createElement(Ut,{isOpen:!!y,isLoading:u,title:y.title,onConfirm:y.onConfirm,onCancel:function(){return I(null)}})):null}var Xt=function(e,t){return t?{watches:Object(ft.a)(Object(ft.a)({},t.watches),{},{watched:[].concat(Object(ct.a)(e.watches.watched),Object(ct.a)(t.watches.watched))})}:e},en=function(e,t){return t?{reviews:Object(ft.a)(Object(ft.a)({},t.reviews),{},{reviews:[].concat(Object(ct.a)(e.reviews.reviews),Object(ct.a)(t.reviews.reviews))})}:e},tn=function(e,t,n){return function(){return e({variables:t,updateQuery:function(e,t){var a=t.fetchMoreResult;return n(e,a)}})}};function nn(e){var t=e.review,n=e.user,a=e.rating,r=e.createdAt;return Q.a.createElement("div",null,Q.a.createElement(H.b,{to:"/profile/".concat(n.name)},n.name),"\xa0",Q.a.createElement("span",{className:"bp3-text-muted"},Object(St.a)(r,Date.now(),{addSuffix:!0})),a&&Q.a.createElement(At,{className:"ml-2",value:a}),Q.a.createElement("p",null,t))}function an(e){var t,n={itemId:e.itemId,tvItemId:e.tvItemId},a=(t={variables:n},G.useQuery(Ne,t)),r=a.data,i=a.loading,l=a.fetchMore;if(i)return Q.a.createElement(qe.B,null);if(!(null===r||void 0===r?void 0:r.reviews))return null;var c=null===r||void 0===r?void 0:r.reviews,o=c.reviews,s=c.hasMore,d=c.cursor;return o.length?Q.a.createElement(Q.a.Fragment,null,o.map((function(e){var t=e.id,n=e.body,a=e.watched,r=a.rating,i=a.user,l=a.createdAt;return Q.a.createElement(nn,{key:t,review:n,user:i,createdAt:l,rating:null===r||void 0===r?void 0:r.value})})),s&&Q.a.createElement(qe.a,{text:"Show more",onClick:tn(l,Object(ft.a)(Object(ft.a)({},n),{},{cursor:d}),en)})):Q.a.createElement(qe.w,{icon:"chat",title:"No reviews yet"})}var rn=n(56);function ln(e){var t,n=e.watched,a=e.onClickEdit,r=e.className,i=n.id,l=n.createdAt,c=n.rating,o=n.review,s=n.tvItem,d=Object(z.useState)({dialogOpen:!1,isLoading:!1}),m=Object(We.a)(d,2),u=m[0],v=m[1],p=(t={update:function(e,t){var n=t.data,a=null===n||void 0===n?void 0:n.removeWatched,r=e.identify({id:a,__typename:"Watched"});a&&r&&(e.evict({id:r}),e.gc())}},G.useMutation(pe,t)),f=Object(We.a)(p,2),E=f[0],g=f[1].loading;return Q.a.createElement(qe.d,{elevation:rn.a.ONE,className:r},Q.a.createElement("div",{className:"flex flex-content-between flex-items-center mb-2"},Q.a.createElement("div",null,Q.a.createElement("span",null,"Seen "),s&&Q.a.createElement("span",null,$t(s)," "),Q.a.createElement("span",{className:"bp3-text-muted mr-2"},Object(St.a)(l,Date.now(),{addSuffix:!0})),c&&Q.a.createElement(At,{value:c.value})),Q.a.createElement(qe.b,null,Q.a.createElement(qe.a,{icon:"edit",small:!0,onClick:function(){return a(n)}},"Edit"),Q.a.createElement(qe.a,{small:!0,icon:"trash",intent:Et.a.DANGER,loading:g,onClick:function(){return v({dialogOpen:!0,isLoading:!1})}},"Remove"),Q.a.createElement(Vt,{cancelButtonText:"Cancel",confirmButtonText:"Remove",icon:"trash",intent:Et.a.DANGER,isOpen:u.dialogOpen,isLoading:u.isLoading,onCancel:function(){return v({dialogOpen:!1,isLoading:!1})},onConfirm:Object(F.a)(q.a.mark((function e(){return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u.dialogOpen){e.next=2;break}return e.abrupt("return");case 2:return v(Object(ft.a)(Object(ft.a)({},u),{},{isLoading:!0})),e.next=5,E({variables:{itemId:i}});case 5:case"end":return e.stop()}}),e)})))},Q.a.createElement("p",null,"Are you sure you want to remove this watched entry?",Q.a.createElement("br",null),Q.a.createElement("br",null),Q.a.createElement("i",null,"This will also remove the associated rating and review if any. Removing cannot be undone."))))),o&&Q.a.createElement("p",null,o.body),!o&&Q.a.createElement("p",{className:"bp3-text-muted"},"No review"))}function cn(e){var t=e.itemId,n=e.userId,a=e.onEdit,r={userId:n,itemId:t},i=Se({variables:r,skip:!n}),l=i.data,c=i.loading,o=i.fetchMore;if(c)return Q.a.createElement(qe.B,null);if(!(null===l||void 0===l?void 0:l.watches))return null;var s=l.watches,d=s.watched,m=s.hasMore,u=s.cursor;return d.length?Q.a.createElement(Q.a.Fragment,null,d.map((function(e){return Q.a.createElement(ln,{key:e.id,watched:e,onClickEdit:function(e){return a(e)}})})),m&&Q.a.createElement(qe.a,{text:"Show more",onClick:tn(o,Object(ft.a)(Object(ft.a)({},r),{},{cursor:u}),Xt)})):Q.a.createElement(qe.w,{icon:"film",title:"Not yet seen",description:"Have you seen it? Watch it or track it!"})}var on=n(61),sn=n(261);function dn(e){var t=e.value,n=e.onChange,a=e.className,r=void 0===a?"":a;return Q.a.createElement(Nt.a,{onChange:n,className:"rating "+r,initialRating:t,fractions:2,fullSymbol:Q.a.createElement(qe.p,{icon:Ct.a.STAR,color:"gold",iconSize:qe.p.SIZE_LARGE}),emptySymbol:Q.a.createElement(qe.p,{icon:Ct.a.STAR_EMPTY,color:"gold",iconSize:qe.p.SIZE_LARGE})})}function mn(e){var t=e.item,n=e.onSubmit,a=e.isLoading,r=e.values,i=void 0===r?{review:"",createdAt:Date.now()}:r;return z.createElement(z.Fragment,null,z.createElement("div",{className:"flex p-3"},t.poster&&z.createElement("div",{className:"pr-3"},z.createElement("img",{src:"https://image.tmdb.org/t/p/w185".concat(t.poster),alt:"Poster for ".concat(t.title),className:"img-responsive"})),z.createElement(on.b,{enableReinitialize:!0,initialValues:i,onSubmit:n},(function(e){var t=e.values,n=e.handleChange,r=e.handleSubmit,i=e.setFieldValue;return z.createElement("form",{className:"flex-grow",onSubmit:r},z.createElement(qe.k,{label:"Watched on",labelFor:"createdAt"},z.createElement(sn.a,{popoverProps:{fill:!0},formatDate:function(e){return e.toLocaleString()},parseDate:function(e){return new Date(e)},placeholder:"M/D/YYYY",onChange:function(e){return i("createdAt",+new Date(e))},value:new Date(t.createdAt)})),z.createElement(qe.k,{label:"Review",labelFor:"review"},z.createElement(qe.F,{fill:!0,growVertically:!0,large:!0,name:"review",onChange:n,value:t.review,placeholder:"Any thoughts on what you watched?"})),z.createElement(qe.k,{label:"Rating",labelFor:"rating"},z.createElement("div",{className:"flex flex-content-between flex-items-center"},z.createElement("div",null,z.createElement(dn,{value:t.rating||0,className:"seen-rating",onChange:function(e){return i("rating",e)}})," ",z.createElement("span",null,t.rating||"?","/5")),t.rating&&z.createElement(qe.a,{icon:"cross",intent:Et.a.DANGER,minimal:!0,small:!0,onClick:function(){return i("rating",void 0)}}))),z.createElement(qe.a,{type:"submit",large:!0,fill:!0,intent:Et.a.PRIMARY,loading:a},"Add"))}))))}var un=function(e,t){return t.filter((function(t){var n=t.name,a=t.seasonName;return"".concat(n," ").concat(a).toLowerCase().includes(e.toLowerCase())}))},vn=function(e,t){var n=t.handleClick,a=t.modifiers,r=t.query;return a.matchesPredicate?z.createElement(z.Fragment,{key:e.id},z.createElement(qe.u,{active:a.active,text:e.name,label:e.seasonName||void 0,onClick:n}),!r&&e.lastSeasonEpisode&&!e.lastSeason&&z.createElement(qe.t,null)):null};function pn(e){var t,n=e.item,a=e.onSubmit,r=e.isLoading,i=e.values,l=void 0===i?{createdAt:Date.now(),review:""}:i,c=(t={variables:{itemId:n.id},skip:!!n.seasons},G.useQuery(De,t)),o=c.data,s=c.loading,d=function(e){return e.reduce((function(t,n,a){var r=n.season_number,i=n.episodes;return t.push.apply(t,Object(ct.a)(i.map((function(t,n){var l=t.id,c=t.name,o=t.episode_number;return{id:l,name:c,seasonName:r?"S".concat(r,"E").concat(o):"",value:{season:r,episode:o},lastSeasonEpisode:n+1===i.length,lastSeason:a+1===e.length}})))),t}),[])}(n.seasons||(null===o||void 0===o?void 0:o.seasons)||[]);return z.createElement("div",{className:"flex p-3"},n.poster&&z.createElement("div",{className:"pr-3"},z.createElement("img",{src:"https://image.tmdb.org/t/p/w185".concat(n.poster),alt:"Poster for ".concat(n.title),className:"img-responsive"})),z.createElement(on.b,{enableReinitialize:!0,initialValues:l,onSubmit:a},(function(e){var t=e.values,n=e.handleChange,a=e.handleSubmit,i=e.setFieldValue;return z.createElement("form",{className:"flex-grow",onSubmit:a},z.createElement(qe.k,{label:"Watched on",labelFor:"createdAt"},z.createElement(sn.a,{popoverProps:{fill:!0},formatDate:function(e){return e.toLocaleString()},parseDate:function(e){return new Date(e)},placeholder:"M/D/YYYY",onChange:function(e){return i("createdAt",+new Date(e))},value:new Date(t.createdAt)})),z.createElement(qe.k,{label:"Episode",labelFor:"tvItemId",helperText:"Empty episode field indicates the whole show"},z.createElement(lt.a,{selectedItem:d.find((function(e){return e.id===t.tvItemId}))||null,inputValueRenderer:function(e){var t=e.name,n=e.seasonName;return"".concat(t," - ").concat(n)},itemRenderer:vn,items:d,itemListPredicate:un,onItemSelect:function(e){var t=e.id;return i("tvItemId",t)},noResults:z.createElement(qe.u,{disabled:!0,text:"Got nothing :("}),popoverProps:{minimal:!0,fill:!0,usePortal:!1,position:qe.A.BOTTOM},disabled:s,inputProps:{placeholder:"Select an episode",rightElement:s?z.createElement(qe.H,{content:"Loading season data"},z.createElement(qe.B,{size:16})):z.createElement(qe.H,{content:"Clear selection"},z.createElement(qe.a,{icon:"cross",minimal:!0,onClick:function(){return i("tvItemId",null)}}))},className:"select-popover-centered"})),z.createElement(qe.k,{label:"Review",labelFor:"review"},z.createElement(qe.F,{fill:!0,growVertically:!0,large:!0,name:"review",onChange:n,value:t.review,placeholder:"Any thoughts on what you watched?"})),z.createElement(qe.k,{label:"Rating",labelFor:"rating"},z.createElement("div",{className:"flex flex-content-between flex-items-center"},z.createElement("div",null,z.createElement(dn,{value:t.rating||0,className:"seen-rating",onChange:function(e){return i("rating",e)}})," ",z.createElement("span",null,t.rating||"?","/5")),t.rating&&z.createElement(qe.a,{icon:"cross",intent:Et.a.DANGER,minimal:!0,small:!0,onClick:function(){return i("rating",void 0)}}))),z.createElement(qe.a,{type:"submit",large:!0,fill:!0,intent:Et.a.PRIMARY,loading:r},"Add"))})))}function fn(e){var t,n,a,r=e.editingWatched,i=e.onSubmit,l=e.isLoading,c=e.item,o=(null===r||void 0===r?void 0:r.isEditing)?{createdAt:r.item.createdAt,review:(null===(t=r.item.review)||void 0===t?void 0:t.body)||"",rating:null===(n=r.item.rating)||void 0===n?void 0:n.value,tvItemId:null===(a=r.item.tvItem)||void 0===a?void 0:a.id}:(null===r||void 0===r?void 0:r.autoTracked)?{createdAt:r.autoTracked.createdAt,tvItemId:r.autoTracked.tvItemId,review:""}:void 0;return"title"in c?Q.a.createElement(mn,{item:{id:c.id,title:c.title,poster:c.poster_path||""},values:o,onSubmit:i,isLoading:l}):"name"in c?Q.a.createElement(pn,{item:{id:c.id,title:c.name,poster:c.poster_path||"",seasons:"seasons"in c?c.seasons:void 0},values:o,onSubmit:i,isLoading:l}):null}function En(e){var t=e.editingWatched,n=e.afterSave,a=e.item,r=me(),i=Object(We.a)(r,2),l=i[0],c=i[1].loading,o=ve({update:function(e){e.gc()}}),s=Object(We.a)(o,2),d=s[0],m=s[1].loading,u=c||m;return Q.a.createElement(fn,{editingWatched:t,item:a,isLoading:u,onSubmit:function(){var e=Object(F.a)(q.a.mark((function e(r){var i,c,o,s,m,u,v,p;return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=r.createdAt,o=r.rating,s=r.review,m=r.tvItemId,(null===t||void 0===t?void 0:t.isEditing)&&(u=d({variables:{createdAt:c,id:t.item.id,tvItemId:m,tvItemType:m?M.Episode:void 0,rating:o?{id:null===(v=t.item.rating)||void 0===v?void 0:v.id,value:o}:void 0,review:s?{id:null===(p=t.item.review)||void 0===p?void 0:p.id,body:s}:void 0},refetchQueries:"autoTracked"in t?["AutoTrackedList"]:void 0})),u=l({variables:{createdAt:c,itemId:a.id,itemType:"name"in a?_.Tv:_.Movie,tvItemId:m,tvItemType:m?M.Episode:void 0,rating:o?{value:o}:void 0,review:s?{body:s}:void 0,autoTrackedId:t&&"autoTracked"in t?null===(i=t.autoTracked)||void 0===i?void 0:i.id:void 0},refetchQueries:["AutoTrackedList"]}),e.next=5,u;case 5:n();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})}function gn(e){var t=e.editingWatched,n=e.item,a=e.onClose,r="name"in n?n.name:n.title;return Q.a.createElement(qe.h,{className:"fluid-dialog",title:"Seen ".concat(r),canOutsideClickClose:!1,onClose:a,isOpen:!!t,portalContainer:Gt(),lazy:!0},Q.a.createElement(En,{editingWatched:t,item:n,afterSave:a}))}function hn(e){e.match;var t,n=Object(z.useState)(null),a=Object(We.a)(n,2),r=a[0],i=a[1],l=Object(V.i)().id,c=be().data,o=ke({variables:{id:l},returnPartialData:!0}).data;if(!(null===o||void 0===o?void 0:o.movie))return null;var s=o.movie,d=s.title,m=s.overview,u=s.poster_path,v=s.vote_count,p=s.vote_average,f=s.release_date,E=v>100?p:null;return Q.a.createElement(Q.a.Fragment,null,Q.a.createElement("div",{style:{position:"relative"}},Q.a.createElement("img",{width:"300",height:"200",className:"img-responsive",src:"https://image.tmdb.org/t/p/w1280".concat(u),style:{position:"relative",maxHeight:"300px",objectFit:"cover"},alt:""})),Q.a.createElement("div",{className:"p-3"},Q.a.createElement(qe.l,null,d),E&&Q.a.createElement(At,{value:E}),f&&Q.a.createElement("p",null,Object(Pt.a)(new Date(f),"yyyy")),Q.a.createElement("p",null,m),(null===c||void 0===c?void 0:c.auth)&&Q.a.createElement(qe.a,{intent:Et.a.PRIMARY,large:!0,onClick:function(){return i({isEditing:!1})}},"Seen it"),(null===c||void 0===c||null===(t=c.auth)||void 0===t?void 0:t.id)&&Q.a.createElement("div",null,Q.a.createElement(qe.m,null,"Your latest tracked"),Q.a.createElement(cn,{itemId:l,userId:c.auth.id,onEdit:function(e){return i({isEditing:!0,item:e})}})),Q.a.createElement("div",null,Q.a.createElement(qe.m,null,"Latest reviews"),Q.a.createElement(an,{itemId:l})),Q.a.createElement(gn,{item:o.movie,editingWatched:r,onClose:function(){return i(null)}})))}var bn=Object(z.forwardRef)((function(e,t){var n=e.episode,a=n.id,r=n.episode_number,i=n.name,l=n.air_date,c=n.overview,o=n.vote_average,s=n.vote_count,d=e.tvId,m=s>1?o:null;return Q.a.createElement("div",{ref:t},Q.a.createElement(H.b,{to:"../"},Q.a.createElement(qe.a,{fill:!0,large:!0,icon:"chevron-left"},"Back to overview")),Q.a.createElement(qe.d,null,Q.a.createElement("div",{className:"flex flex-content-between mb-3"},Q.a.createElement("div",null,Q.a.createElement(qe.n,{className:"mb-0"},r," ",i),m&&Q.a.createElement(At,{value:m})),l&&Q.a.createElement("div",null,Object(Pt.a)(+l,"do MMM yyyy"))),Q.a.createElement("p",null,c)),Q.a.createElement("div",null,Q.a.createElement(qe.m,null,"Latest reviews"),Q.a.createElement(an,{itemId:d,tvItemId:a})))}));function wn(e){var t=e.season,n=e.expanded,a=void 0!==n&&n,r=Object(z.useState)(a),i=Object(We.a)(r,2),l=i[0],c=i[1];return Q.a.createElement(qe.d,{key:t.id,className:"mb-2"},Q.a.createElement("div",{className:"flex"},Q.a.createElement("img",{className:"img-responsive",style:{maxWidth:100,objectFit:"contain"},width:"300",height:"200",src:"https://image.tmdb.org/t/p/w780".concat(t.poster_path),alt:"Season ".concat(t.id," poster")}),Q.a.createElement("div",{className:"w-100 pl-3"},Q.a.createElement("div",{className:"mb-3 flex flex-content-between flex-items-center"},Q.a.createElement(qe.n,{className:"mb-0"},t.name),t.air_date&&Q.a.createElement("div",null,Object(Pt.a)(+t.air_date,"yyyy"))),Q.a.createElement("p",null,t.overview))),Q.a.createElement(qe.i,{className:"my-3"}),Q.a.createElement(qe.g,{isOpen:l},Q.a.createElement(qe.n,null,"Episodes"),Q.a.createElement("div",null,t.episodes.map((function(e,t){return Q.a.createElement("div",{key:e.id,className:"flex mb-3"},Q.a.createElement("div",{className:"pr-3 text-center",style:{width:"32px"}},Q.a.createElement(qe.E,{ellipsize:!0},e.episode_number)),Q.a.createElement("div",{className:"w-100"},Q.a.createElement("div",{className:"pb-2 flex flex-content-between"},Q.a.createElement("div",null,Q.a.createElement("strong",null,e.name)),Q.a.createElement("div",{className:"pl-3"},e.air_date&&Q.a.createElement(qe.E,{ellipsize:!0},Object(Pt.a)(+e.air_date,"do MMM yyyy")))),Q.a.createElement("div",null,Q.a.createElement("p",null,e.overview),Q.a.createElement(H.b,{to:function(t){var n=t.pathname;return"".concat(n.replace(/\/$/,""),"/episode/").concat(e.id)}},Q.a.createElement(qe.a,null,"View reviews")))))})))),Q.a.createElement(qe.a,{fill:!0,minimal:!0,icon:l?"collapse-all":"expand-all",onClick:function(){return c(!l)}},l?"Collapse":"Expand"))}function yn(e){var t=e.tv,n=e.itemId,a=e.userId,r=e.onEditWatched;return Q.a.createElement(Q.a.Fragment,null,a&&Q.a.createElement("div",null,Q.a.createElement(qe.m,null,"Your latest tracked"),Q.a.createElement(cn,{itemId:n,userId:a,onEdit:r})),Q.a.createElement("div",null,Q.a.createElement(qe.m,null,"Seasons"),t.seasons.map((function(e){return Q.a.createElement(wn,{key:e.id,season:e,tvId:n})}))),Q.a.createElement("div",null,Q.a.createElement(qe.m,null,"Latest reviews"),Q.a.createElement(an,{itemId:n})))}function In(e){var t,n,a,r=e.tv,i=e.editingWatched,l=e.onClose,c=me(),o=Object(We.a)(c,2),s=o[0],d=o[1],m=ve({update:function(e){e.gc()}}),u=Object(We.a)(m,1)[0];return Q.a.createElement(qe.h,{className:"fluid-dialog",title:"Seen ".concat(r.title),canOutsideClickClose:!1,onClose:l,isOpen:!!i,lazy:!0,portalContainer:Gt()},Q.a.createElement(pn,{item:r,values:(null===i||void 0===i?void 0:i.isEditing)?{createdAt:i.item.createdAt,review:(null===(t=i.item.review)||void 0===t?void 0:t.body)||"",rating:null===(n=i.item.rating)||void 0===n?void 0:n.value,tvItemId:null===(a=i.item.tvItem)||void 0===a?void 0:a.id}:(null===i||void 0===i?void 0:i.autoTracked)?{createdAt:i.autoTracked.createdAt,tvItemId:i.autoTracked.tvItemId,review:""}:void 0,isLoading:d.loading,onSubmit:function(){var e=Object(F.a)(q.a.mark((function e(t){var n,a,c,o,d,m,v,p;return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.createdAt,c=t.rating,o=t.review,d=t.tvItemId,(null===i||void 0===i?void 0:i.isEditing)&&(m=u({variables:{createdAt:a,id:i.item.id,tvItemId:d,tvItemType:d?M.Episode:void 0,rating:c?{id:null===(v=i.item.rating)||void 0===v?void 0:v.id,value:c}:void 0,review:o?{id:null===(p=i.item.review)||void 0===p?void 0:p.id,body:o}:void 0}})),m=s({variables:{createdAt:a,itemId:r.id,itemType:_.Tv,tvItemId:d,tvItemType:d?M.Episode:void 0,rating:c?{value:c}:void 0,review:o?{body:o}:void 0,autoTrackedId:i&&"autoTracked"in i?null===(n=i.autoTracked)||void 0===n?void 0:n.id:void 0}}),e.next=5,m;case 5:l();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}))}function On(e){var t=e.match,n=Object(z.useState)(null),a=Object(We.a)(n,2),r=a[0],i=a[1],l=Object(V.i)().id,c=be().data,o=je({variables:{id:l}}).data;if(!(null===o||void 0===o?void 0:o.tv))return null;var s=o.tv,d=s.name,m=s.overview,u=s.first_air_date,v=s.vote_count,p=s.vote_average,f=s.poster_path,E=s.seasons,g=v>100?p:null;return Q.a.createElement(Q.a.Fragment,null,Q.a.createElement("div",{style:{position:"relative"}},Q.a.createElement("img",{width:"300",height:"200",className:"img-responsive",src:"https://image.tmdb.org/t/p/w1280".concat(f),style:{position:"relative",maxHeight:"300px",objectFit:"cover"},alt:""})),Q.a.createElement("div",{className:"p-3"},Q.a.createElement(qe.l,null,d),g&&Q.a.createElement(At,{value:g}),u&&Q.a.createElement("p",null,Object(Pt.a)(new Date(u),"yyyy")),Q.a.createElement("p",null,m),(null===c||void 0===c?void 0:c.auth)&&Q.a.createElement(qe.a,{intent:Et.a.PRIMARY,large:!0,onClick:function(){return i({isEditing:!1})}},"Seen it"),Q.a.createElement(V.d,null,Q.a.createElement(V.b,{path:"".concat(t.path,"/episode/:episodeId"),render:function(e){var t=e.match,n=function(e,t){for(var n=0;n<e.length;n=1){var a=e[n].episodes.find((function(e){return e.id===t}));if(a)return a}}(E,t.params.episodeId);return n?n&&Q.a.createElement(bn,{tvId:l,episode:n}):null}}),Q.a.createElement(V.b,{path:"".concat(t.path),render:function(e){var t;e.match;return Q.a.createElement(yn,{tv:o.tv,userId:null===c||void 0===c||null===(t=c.auth)||void 0===t?void 0:t.id,itemId:l,onEditWatched:function(e){return i({isEditing:!0,item:e})}})}})),Q.a.createElement(In,{tv:{id:o.tv.id,title:d,poster:o.tv.poster_path||"",seasons:E},editingWatched:r,onClose:function(){return i(null)}})))}var kn=n(142),xn=new RegExp("^(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:\\*\\.?)?(?:[a-z0-9\\u00a1-\\uffff][a-z0-9\\u00a1-\\uffff_-]{0,62})?[a-z0-9\\u00a1-\\uffff]\\.)+((?:\\*)|(?:[a-z\\u00a1-\\uffff]{2,}\\.?)))(?::\\d{2,5})?(?:[/?#]\\S*)?$","i");function jn(e,t,n,a,r,i){if(e&&xn.test(e))if(i)r("This address is already covered.");else{var l="^".concat(e.replace(/[.+?^${}()/|[\]\\]/g,"\\$&").replace(/\*/g,".*").toLowerCase());t.includes(l)?r("This address is already in the list."):(a([].concat(Object(ct.a)(t),[l])),n(""))}else r("Invalid address")}var Tn=function(e){var t=e.id,n=e.list,a=e.updateList,r=e.helperTextPrefix,i=z.useState(""),l=Object(We.a)(i,2),c=l[0],o=l[1],s=z.useState(""),d=Object(We.a)(s,2),m=d[0],u=d[1],v=n.reduce((function(e,t){var n=!!c&&new RegExp(t,"i").test(c);return e.hasClashing=e.hasClashing||!!n,e.list.push({matches:n,display:t.replace(/\^|\.(\*)|\\/g,"$1")}),e}),{list:[],hasClashing:!1}),p=v.list,f=v.hasClashing;return z.createElement(z.Fragment,null,z.createElement(qe.k,{label:"Blacklisted sites",labelFor:"blacklist-input",helperText:z.createElement(z.Fragment,null,r,z.createElement("span",null,"Supports basic wildcards, some supported examples:",z.createElement("br",null),"youtube.*",z.createElement("br",null),"*.google.com/video/*",z.createElement("br",null),"netflix.com/watch/80186674"))},z.createElement(qe.r,{id:t,value:c,intent:m?Et.a.DANGER:Et.a.NONE,placeholder:"facebook.com/video/*",onChange:function(e){var t=e.currentTarget;o(t.value),u("")},onKeyPress:function(e){return"Enter"===e.key?jn(e.target.value,n,o,a,u,f):null},rightElement:z.createElement(qe.a,{onClick:function(){return jn(c,n,o,a,u,f)},icon:"add",minimal:!0})}),m?z.createElement(qe.c,{intent:Et.a.DANGER},m):null),z.createElement("ul",null,p.map((function(e,t){return z.createElement("li",{key:e.display,style:{color:e.matches?kn.a.RED1:"inherit"}},e.display,z.createElement(qe.a,{icon:"delete",intent:e.matches?Et.a.DANGER:Et.a.NONE,minimal:!0,onClick:function(){return a(n.filter((function(e){return e!==n[t]})))}}))}))))};function Cn(e){var t=e.imported,n=(e.original,e.isSelected),a=e.onSelect,r=e.onDeselect,i=(e.onSave,e.onRemove),l=Object(V.h)(),c=new URLSearchParams(l.search);return t&&(t=Object(ft.a)(Object(ft.a)({},t),{},{review:{body:"laba diena su vistiena"}})),Q.a.createElement(qe.d,{className:"card-watched fill-container ".concat(n?"selected":""),elevation:n?4:void 0,onClick:n?r:a},t&&Q.a.createElement(Q.a.Fragment,null,Q.a.createElement("div",{style:{position:"relative"}},Q.a.createElement("img",{width:"300",height:"200",className:"img-responsive",src:"https://image.tmdb.org/t/p/w342".concat(t.item.poster_path),alt:"".concat(t.item.title," poster")}),Q.a.createElement("div",{className:"item-text-overlay"},Q.a.createElement("div",{className:"item-text-overlay-top p-3 pb-4"},Q.a.createElement("div",{className:"flex flex-content-between flex-items-center"},Q.a.createElement("strong",{className:"bp3-text-large bp3-text-overflow-ellipsis pr-2"},t.item.title),Q.a.createElement("div",null,$t(void 0)||"S02E13")),Q.a.createElement("div",{className:"flex flex-content-between"},Q.a.createElement("div",{className:"bp3-text-small card-watched-muted"},Q.a.createElement(Wt,{date:t.createdAt})),t.rating&&Q.a.createElement(At,{value:2*t.rating.value,size:jt.Small}))),t.review&&Q.a.createElement("div",{className:"item-text-overlay-bottom p-3 pt-4"},Q.a.createElement("div",{className:"text-ellipsis"},Q.a.createElement(qe.p,{icon:"comment",className:"pr-2"}),t.review.body))))),!t&&Q.a.createElement(qe.w,{icon:"help",title:"Couldn't match item",description:Q.a.createElement("div",{className:"text-left px-2",style:{width:"100%"}},Q.a.createElement("div",{className:"mb-3"},Q.a.createElement("strong",null,"Here's what we know:")),Q.a.createElement("div",{className:"mb-1"}))}),Q.a.createElement(qe.b,{fill:!0,minimal:!0,onClick:Yt()},void 0,Q.a.createElement(H.b,{to:{search:c.toString()},replace:!0,className:"bp3-button"},Q.a.createElement(qe.p,{icon:"edit",className:"mr-2"}),Q.a.createElement("span",null,"Edit")),Q.a.createElement(qe.a,{icon:"trash",onClick:i},"Remove")))}function Sn(){var e,t=Object(z.useState)(!0),n=Object(We.a)(t,2),a=n[0],r=n[1],i=Object(z.useState)(null),l=Object(We.a)(i,2),c=l[0],o=l[1],s=!!c&&c.size>102400,d=(e={notifyOnNetworkStatusChange:!0},G.useLazyQuery(_e,e)),m=Object(We.a)(d,2),u=m[0],v=m[1],p=Object(z.useState)([]),f=Object(We.a)(p,2),E=f[0],g=f[1],h=Object(z.useState)("initial"),b=Object(We.a)(h,2),w=b[0],y=b[1],I=Object(z.useRef)(null);return Object(z.useEffect)((function(){v.data&&!v.loading&&y("selecting")}),[v.data,v.loading]),Object(z.useEffect)((function(){v.data&&g(Array.from(v.data.importLetterboxd.keys()))}),[v.data]),Q.a.createElement(Q.a.Fragment,null,Q.a.createElement("p",null,"We support a multitude of import formats including our custom own. All of the formats are CSV based, select the desired format to learn more."),Q.a.createElement("p",{className:"mb-4"},"After uploading a file and startig import you'll be able to preview the data."),a?Q.a.createElement(qe.D,{defaultSelectedTabId:"letterboxd",vertical:!0},Q.a.createElement(qe.C,{id:"general",title:"General",panel:Q.a.createElement("p",null,"We support a multitude of import formats including our custom own.")}),Q.a.createElement(qe.C,{id:"letterboxd",title:"Letterboxd",panelClassName:"flex-grow",panel:"selecting"===w?function(){var e,t,n;return Q.a.createElement(Q.a.Fragment,null,Q.a.createElement("p",null,"Successfully read your import. You can edit the items before saving."),Q.a.createElement("div",{className:"p-2 sticky-below-header flex flex-items-center"},Q.a.createElement(qe.a,{icon:"chevron-left",text:"Cancel",small:!0,className:"mr-4",onClick:function(){y("initial"),o(null),I.current&&(I.current.files=null)}}),Q.a.createElement("div",{className:"flex flex-grow flex-content-end flex-items-center"},Q.a.createElement(qe.e,{className:"m-0 py-2",checked:E.length===(null===(e=v.data)||void 0===e?void 0:e.importLetterboxd.length),indeterminate:!!E.length&&E.length<((null===(t=v.data)||void 0===t?void 0:t.importLetterboxd.length)||0),label:E.length?"".concat(E.length," Selected"):"Select all",onChange:function(){var e,t;return g(E.length===(null===(e=v.data)||void 0===e?void 0:e.importLetterboxd.length)?[]:Array.from(((null===(t=v.data)||void 0===t?void 0:t.importLetterboxd)||[]).keys()))}}),Q.a.createElement(qe.a,{small:!0,className:"ml-2",icon:"tick",disabled:!E.length,onClick:Object(F.a)(q.a.mark((function e(){return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))},"Save"))),Q.a.createElement("div",{className:"grid grid-card"},null===(n=v.data)||void 0===n?void 0:n.importLetterboxd.map((function(e,t){var n=e.imported,a=e.original;return Q.a.createElement("div",{key:t,className:Mt.a.INTENT_PRIMARY,style:{position:"relative"}},E.includes(t)&&Q.a.createElement(qe.p,{icon:"tick-circle",intent:Et.a.PRIMARY,iconSize:16,style:{position:"absolute",left:-8,top:-8,zIndex:1}}),Q.a.createElement(Cn,{imported:n,original:a,isSelected:E.includes(t),onSave:function(){},onSelect:function(){return g([].concat(Object(ct.a)(E),[t]))},onDeselect:function(){return g(E.filter((function(e){return e!==t})))},onRemove:function(){}}))}))))}():Q.a.createElement(Q.a.Fragment,null,Q.a.createElement("p",null,"Letterboxd allows"," ",Q.a.createElement("a",{href:"https://letterboxd.com/settings/data/",target:"_blank",rel:"noopener noreferrer"},"exporting your data"),". The export should download a zip file. Input that file here."),Q.a.createElement("p",null,"Filesize is limited to 100kb. If your file exceeds this limit let us know at ",Q.a.createElement("a",{href:"mailto:".concat("help@seenit.show")},"help@seenit.show"),"."),Q.a.createElement(qe.k,{intent:s?Et.a.DANGER:void 0,helperText:s&&"Maximum size is 100kb"},Q.a.createElement(qe.j,{hasSelection:!!c,text:(null===c||void 0===c?void 0:c.name)||"Letterboxd zip file",inputProps:{accept:".zip",ref:I},onInputChange:function(e){var t;o((null===(t=e.target.files)||void 0===t?void 0:t[0])||null)}})),Q.a.createElement(qe.a,{disabled:!c||s,onClick:function(){var e={file:c};if(v.refetch)return v.refetch(e);u({variables:e})},loading:v.loading,text:"Start import"}))}),Q.a.createElement(qe.C,{id:"rotten",title:"Rotten Tomatoes",panel:Q.a.createElement("div",null,"tmasd")}),Q.a.createElement(qe.C,{id:"imdb",title:"IMDB",panel:Q.a.createElement("div",null,"tmasd")})):Q.a.createElement(qe.a,{text:"Import data",onClick:function(){return r(!0)}}))}function Nn(){var e,t=(e={pollInterval:6e4,fetchPolicy:"network-only"},G.useQuery(Le,e)),n=t.data,a=t.loading,r=null===n||void 0===n?void 0:n.settings,i=function(e){return G.useMutation(ge,e)}({update:function(e,t){var n=t.data;n&&function(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null===(n=e.readQuery({query:he}))||void 0===n?void 0:n.auth;if(a)ht("userData",Object(ft.a)(Object(ft.a)({},a),{},{settings:t})),e.writeQuery({query:Le,data:{settings:t}})}(e,n.updateSettings)}}),l=Object(We.a)(i,1)[0],c=a||!r?null:{general:{autoConvert:r.general.autoConvert},extension:{autoTrack:r.extension.autoTrack,minLengthSeconds:r.extension.minLengthSeconds,blacklist:r.extension.blacklist}};return Q.a.createElement(Q.a.Fragment,null,Q.a.createElement(qe.l,null,"Settings"),Q.a.createElement(qe.D,{defaultSelectedTabId:"importexport"},Q.a.createElement(qe.C,{id:"preferences",title:"Preferences",panel:c?Q.a.createElement(on.b,{onSubmit:function(e){return l({variables:e})},enableReinitialize:!0,initialValues:c},(function(e){var t=e.values,n=e.handleChange,a=e.setFieldValue,r=e.isSubmitting;return Q.a.createElement(on.a,null,Q.a.createElement("div",null,Q.a.createElement(qe.m,{className:"mt-4"},"General"),Q.a.createElement("p",{className:"mb-4"},"Site specific settings"),Q.a.createElement(qe.k,{label:"Auto tracked",helperText:"Enabling this publishes identified auto tracked items directly to your watched list instead of saving them as a draft first"},Q.a.createElement(qe.e,{name:"general.autoConvert",label:"Automatically publish eligible items",checked:t.general.autoConvert,onChange:n}))),Q.a.createElement("div",null,Q.a.createElement(qe.m,{className:"mt-4"},"Extension"),Q.a.createElement("p",{className:"mb-4"},"Controls the browser extension behavior"),Q.a.createElement(qe.k,{label:"Tracking",helperText:"Enabling this removes the watched popup after finishing a video and instead automatically saves the item as a draft"},Q.a.createElement(qe.e,{name:"extension.autoTrack",label:"Automatically track finished videos",checked:t.extension.autoTrack,onChange:n})),Q.a.createElement(qe.k,{label:"Minimum video length",helperText:"Specify minimum amount in seconds for videos to be registered as watched"},Q.a.createElement(qe.x,{onValueChange:function(e){return a("extension.minLengthSeconds",e)},value:t.extension.minLengthSeconds})),Q.a.createElement(Tn,{list:t.extension.blacklist,updateList:function(e){return a("extension.blacklist",e)},helperTextPrefix:Q.a.createElement("p",null,"List of domains that are not tracked")})),Q.a.createElement(qe.a,{type:"submit",loading:r},"Save"))})):Q.a.createElement(qe.B,{size:16})}),Q.a.createElement(qe.C,{id:"importexport",title:"Import / Export",panel:Q.a.createElement(Sn,null)})))}function An(){return Q.a.createElement(qe.w,{icon:"map",className:"p-5",title:"Uh oh",description:"Page not found. You sure the link is correct?",action:Q.a.createElement(H.b,{to:"/"},Q.a.createElement(qe.a,null,"Go to homepage"))})}function Rn(e){var t=e.children;return Q.a.createElement("div",{className:"p-4"},t)}function $n(e){var t=e.item,n=e.editingWatched,a=e.onClose,r=Object(z.useState)(),i=Object(We.a)(r,2),l=i[0],c=i[1],o={id:null===l||void 0===l?void 0:l.id},s=je({variables:o,skip:(null===l||void 0===l?void 0:l.type)!==_.Tv}),d=ke({variables:o,skip:(null===l||void 0===l?void 0:l.type)!==_.Movie}),m=(null===l||void 0===l?void 0:l.type)===_.Movie?d:s,u=m.data,v=m.loading,p=u?"tv"in u?u.tv:u.movie:void 0,f=t||p,E=t?"Seen ".concat("name"in t?t.name:t.title):"Find auto tracked",g=n&&!n.isEditing&&n.autoTracked?n.autoTracked.meta:void 0;return Q.a.createElement(qe.h,{className:"fluid-dialog",title:E,canOutsideClickClose:!1,isOpen:!!n,lazy:!0,onClose:a,portalContainer:Gt()},!t&&n&&"autoTracked"in n&&n.autoTracked&&Q.a.createElement("div",{className:"p-3"},Q.a.createElement("p",null,"Seen ",Q.a.createElement(Wt,{date:n.autoTracked.createdAt})),Q.a.createElement("strong",null,"Here's what we know:"),g&&g.title&&Q.a.createElement("p",{className:"mb-1"},Q.a.createElement("span",null,"Title read as "),Q.a.createElement(qe.f,null,g.title)),g&&g.tvData&&Q.a.createElement("div",{className:"mb-1"},Q.a.createElement("span",null,"TV info - "),g.tvData.season&&Q.a.createElement("span",null,"S",g.tvData.season),g.tvData.episode&&Q.a.createElement("span",null,"E",g.tvData.episode)),g&&g.provider&&Q.a.createElement("div",{className:"mb-1"},Q.a.createElement("span",null,"Tracked on ",g.provider,", from"),Q.a.createElement("br",null),g.url&&Q.a.createElement(qe.f,{className:"mt-1",style:{display:"inline-block",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"320px",overflow:"hidden"}},g.url),g.filename&&Q.a.createElement(qe.f,{className:"mt-1",style:{display:"inline-block",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"320px",overflow:"hidden"}},g.filename)),Q.a.createElement(mt,{selected:l,setSelected:c})),v&&Q.a.createElement(qe.B,null),f&&!v&&Q.a.createElement(En,{item:f,editingWatched:n,afterSave:a}))}var Dn=function(e){var t=Object(V.g)();return Q.a.createElement($n,Object.assign({},e,{onClose:function(){var e=new URLSearchParams(t.location.search);e.delete(zt.EditingAutoTracked),t.replace("".concat(t.location.pathname,"?").concat(e))}}))},Ln=function(e){var t=Object(V.g)();return Q.a.createElement(gn,Object.assign({},e,{onClose:function(){var e=new URLSearchParams(t.location.search);e.delete(zt.EditingWatched),t.replace("".concat(t.location.pathname,"?").concat(e))}}))};function _n(){var e,t=new URLSearchParams(Object(V.h)().search),n=t.get(zt.EditingAutoTracked),a=t.get(zt.EditingWatched),r=(e={variables:{id:n||""},skip:!n},G.useQuery($e,e)).data,i=function(e){return G.useQuery(Te,e)}({variables:{id:a||""},skip:!a}).data;if(n&&r){var l,c=r.autoTracked;return Q.a.createElement(Dn,{item:c.item,editingWatched:{isEditing:!1,autoTracked:{id:c.id,createdAt:c.createdAt,meta:c.meta,tvItemId:null===(l=c.tvItem)||void 0===l?void 0:l.id}}})}if(a&&i){var o=i.watched;return Q.a.createElement(Ln,{editingWatched:{isEditing:!0,item:o},item:o.item})}return null}function Mn(){return Q.a.createElement("div",{id:"app-main",className:"app-container bp3-dark"},Q.a.createElement(vt,null),Q.a.createElement("div",null,Q.a.createElement(V.d,null,Q.a.createElement(Pe,{exact:!0,path:"/",component:Kt,redirectComponent:xt}),Q.a.createElement(V.b,{path:"/movie/:id",component:hn}),Q.a.createElement(V.b,{path:"/tv/:id",component:On}),Q.a.createElement(V.b,{exact:!0,path:"/profile/:name",component:Lt}),Q.a.createElement(Rn,null,Q.a.createElement(V.d,null,Q.a.createElement(V.b,{exact:!0,path:"/setup",component:_t}),Q.a.createElement(V.b,{exact:!0,path:"/login",component:wt}),Q.a.createElement(Pe,{exact:!0,path:"/settings",component:Nn}),Q.a.createElement(V.b,{path:"*",component:An})))),Q.a.createElement(_n,null)))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Pn,Wn=n(161),qn=n(158),Fn=n(159),zn=n(160),Qn=Object(G.gql)(Pn||(Pn=Object(Z.a)(["\n  extend type Query {\n    auth: User\n    isExtensionCheckDone: Boolean\n  }\n"]))),Bn={Mutation:{logout:function(e,t,n){var a=n.cache;n.client;bt(a);var r={ROOT_QUERY:{isExtensionCheckDone:a.extract().ROOT_QUERY.isExtensionCheckDone}};a.restore(r)}}},Yn={possibleTypes:{Item:["Movie","Tv"],TvItem:["Season","Episode"],TmdbMedia:["TmdbMovie","TmdbTv"],AutoTrackedResult:["AutoTracked","Watched"]}},Gn={WatchedCursor:{fields:{watched:{read:function(e,t){var n=t.readField;return e.filter((function(e){return!!n("id",e)}))}}}},Query:{fields:{autoTracked:function(e,t){var n=t.args;return(0,t.toReference)({__typename:"AutoTracked",id:null===n||void 0===n?void 0:n.id})}}}},Hn=new Promise((function(e,t){document.addEventListener("seenit-extension-sync",(function(){return e(!0)})),setTimeout((function(){return t("timeout")}),5e3)})).catch((function(){return!1})),Vn=new Promise((function(e,t){try{chrome.runtime.sendMessage("fobdnlhhghamfijjkfjjpfjaeffkelgk","ping",(function(n){return chrome.runtime.lastError?t(chrome.runtime.lastError):"pong"===n?e(!0):void 0}))}catch(n){t(n)}})).then((function(){return Hn})).catch((function(){return!1}));Vn.then((function(e){Zn.writeQuery({query:he,data:{auth:gt("userData")||null}}),Zn.writeQuery({query:we,data:{isExtensionCheckDone:!0}})}));var Un=Object(qn.a)((function(e){var t=e.graphQLErrors;e.networkError;(null===t||void 0===t?void 0:t.some((function(e){var t=e.extensions;return"UNAUTHENTICATED"===(void 0===t?{}:t).code})))&&bt(Zn)})),Zn=new G.InMemoryCache({possibleTypes:Yn.possibleTypes,typePolicies:Gn}),Jn="https://server.seenit.show/graphql",Kn=(new Wn.a({uri:Jn}),Object(Fn.a)(function(){var e=Object(F.a)(q.a.mark((function e(t){var n;return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Vn;case 2:return n=gt("token"),e.abrupt("return",{headers:{authorization:n?"Bearer ".concat(n):""}});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),Xn=new G.ApolloClient({cache:Zn,resolvers:Bn,link:G.ApolloLink.from([Un,Kn,Object(zn.a)({uri:Jn})]),typeDefs:Qn}),ea=function(e){var t,n=e.children,a=G.useQuery(we,t).data;return(null===a||void 0===a?void 0:a.isExtensionCheckDone)?Q.a.createElement(Q.a.Fragment,null,n):null};Object(F.a)(q.a.mark((function e(){return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Y.a.render(Q.a.createElement(G.ApolloProvider,{client:Xn},Q.a.createElement(H.a,null,Q.a.createElement(ea,null,Q.a.createElement(Mn,null)))),document.getElementById("root"));case 1:case"end":return e.stop()}}),e)})))(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[198,1,2]]]);
//# sourceMappingURL=main.e2cfc94f.chunk.js.map