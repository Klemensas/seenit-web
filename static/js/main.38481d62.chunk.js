(this["webpackJsonpseenit-web"]=this["webpackJsonpseenit-web"]||[]).push([[0],{136:function(e,t,n){e.exports=n.p+"static/media/chrome.fb7a4d16.svg"},137:function(e,t,n){e.exports=n.p+"static/media/vlc.78c4bd2f.svg"},180:function(e,t,n){e.exports=n(236)},185:function(e,t,n){},186:function(e,t,n){},236:function(e,t,n){"use strict";n.r(t);var a,r,i,l,c=n(22),o=n.n(c),s=n(0),u=n.n(s),d=n(31),m=n.n(d),v=n(7),p=n(19),f=(n(185),n(42)),E=(n(186),n(83)),g=n(14);function h(){var e=Object(g.a)(["\n  query Settings {\n    settings {\n      general {\n        autoConvert\n      }\n      extension {\n        autoTrack\n        minLengthSeconds\n        blacklist\n      }\n    }\n  }\n"]);return h=function(){return e},e}function b(){var e=Object(g.a)(["\n  query Seasons($itemId: ID!) {\n    seasons(itemId: $itemId) {\n      ...SeasonProps\n    }\n  }\n  ","\n"]);return b=function(){return e},e}function w(){var e=Object(g.a)(["\n  query AutoTracked($id: ID!) {\n    autoTracked(id: $id) {\n      id\n      itemType\n      item {\n        ...ItemData\n      }\n      tvItemType\n      tvItem {\n        ...WatchedTvItemProps\n      }\n      meta {\n        title\n        filename\n        url\n        provider\n        tvData {\n          season\n          episode\n        }\n      }\n      createdAt\n    }\n  }\n  ","\n  ","\n"]);return w=function(){return e},e}function y(){var e=Object(g.a)(["\n  query AutoTrackedList($userId: ID!, $cursor: String) {\n    autoTrackedList(userId: $userId, cursor: $cursor) {\n      cursor\n      hasMore\n      autoTracked {\n        id\n        itemType\n        item {\n          ...ItemData\n        }\n        tvItemType\n        tvItem {\n          ...WatchedTvItemProps\n        }\n        meta {\n          title\n          filename\n          url\n          provider\n          tvData {\n            season\n            episode\n          }\n        }\n        createdAt\n      }\n    }\n  }\n  ","\n  ","\n"]);return y=function(){return e},e}function I(){var e=Object(g.a)(["\n  query SearchContent($title: String!) {\n    searchContent(title: $title) {\n      id\n      tmdbId\n      title\n      release_date\n      type\n    }\n  }\n"]);return I=function(){return e},e}function O(){var e=Object(g.a)(["\n  query Reviews(\n    $userId: ID\n    $itemId: ID\n    $itemType: ItemType\n    $cursor: String\n    $tvItemId: ID\n    $tvItemType: TvItemType\n  ) {\n    reviews(\n      userId: $userId\n      itemId: $itemId\n      itemType: $itemType\n      cursor: $cursor\n      tvItemId: $tvItemId\n      tvItemType: $tvItemType\n    ) {\n      cursor\n      hasMore\n      reviews {\n        id\n        body\n        watched {\n          id\n          createdAt\n          rating {\n            id\n            value\n          }\n          tvItemType\n          tvItem {\n            ...WatchedTvItemProps\n          }\n          user {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return O=function(){return e},e}function T(){var e=Object(g.a)(["\n  query Watches(\n    $userId: ID\n    $itemId: ID\n    $itemType: ItemType\n    $cursor: String\n    $tvItemId: ID\n    $tvItemType: TvItemType\n  ) {\n    watches(\n      userId: $userId\n      itemId: $itemId\n      itemType: $itemType\n      cursor: $cursor\n      tvItemId: $tvItemId\n      tvItemType: $tvItemType\n    ) {\n      ...WatchedCursorWithItemsProps\n    }\n  }\n  ","\n"]);return T=function(){return e},e}function k(){var e=Object(g.a)(["\n  query Watched($id: ID!) {\n    watched(id: $id) {\n      ...WatchedProps\n      ...WatchedItemProps\n    }\n  }\n  ","\n  ","\n"]);return k=function(){return e},e}function x(){var e=Object(g.a)(['\n  query Tv($id: ID, $cursor: String) {\n    tv(id: $id) {\n      id\n      name\n      overview\n      first_air_date\n      poster_path\n      backdrop_path\n      vote_average\n      vote_count\n      seasons {\n        ...SeasonProps\n      }\n      watched(cursor: $cursor, filter: "Reviewed") {\n        ...WatchedCursorProps\n      }\n    }\n  }\n  ',"\n  ","\n"]);return x=function(){return e},e}function j(){var e=Object(g.a)(['\n  query Movie($id: ID, $cursor: String) {\n    movie(id: $id) {\n      id\n      title\n      overview\n      release_date\n      poster_path\n      backdrop_path\n      vote_average\n      vote_count\n      watched(cursor: $cursor, filter: "Reviewed") {\n        ...WatchedCursorProps\n      }\n    }\n  }\n  ',"\n"]);return j=function(){return e},e}function C(){var e=Object(g.a)(["\n  query User($name: String, $id: ID, $cursor: String) {\n    user(name: $name, id: $id) {\n      id\n      name\n      createdAt\n      watched(cursor: $cursor) {\n        ...WatchedCursorWithItemsProps\n      }\n    }\n  }\n  ","\n"]);return C=function(){return e},e}function N(){var e=Object(g.a)(["\n  query IsExtensionCheckDone {\n    isExtensionCheckDone @client\n  }\n"]);return N=function(){return e},e}function S(){var e=Object(g.a)(["\n  query Auth {\n    auth @client {\n      id\n      name\n      email\n      createdAt\n      settings {\n        general {\n          autoConvert\n        }\n        extension {\n          autoTrack\n          minLengthSeconds\n          blacklist\n        }\n      }\n    }\n  }\n"]);return S=function(){return e},e}function A(){var e=Object(g.a)(["\n  mutation UpdateSettings(\n    $general: GeneralSettingsInput!\n    $extension: ExtensionSettingsInput!\n  ) {\n    updateSettings(general: $general, extension: $extension) {\n      general {\n        autoConvert\n      }\n      extension {\n        autoTrack\n        minLengthSeconds\n        blacklist\n      }\n    }\n  }\n"]);return A=function(){return e},e}function $(){var e=Object(g.a)(["\n  mutation ConvertAutoTracked($ids: [ID!]!) {\n    convertAutoTracked(ids: $ids) {\n      removedIds\n    }\n  }\n"]);return $=function(){return e},e}function R(){var e=Object(g.a)(["\n  mutation RemoveAutoTracked($ids: [ID!]!) {\n    removeAutoTracked(ids: $ids)\n  }\n"]);return R=function(){return e},e}function D(){var e=Object(g.a)(["\n  mutation RemoveWatched($itemId: ID!) {\n    removeWatched(itemId: $itemId)\n  }\n"]);return D=function(){return e},e}function L(){var e=Object(g.a)(["\n  mutation EditWatched(\n    $id: ID!\n    $createdAt: Float!\n    $rating: RatingInput\n    $review: ReviewInput\n    $tvItemId: ID\n    $tvItemType: TvItemType\n  ) {\n    editWatched(\n      id: $id\n      createdAt: $createdAt\n      rating: $rating\n      review: $review\n      tvItemId: $tvItemId\n      tvItemType: $tvItemType\n    ) {\n      id\n      itemType\n      createdAt\n      rating {\n        id\n        value\n      }\n      review {\n        id\n        body\n      }\n      tvItemType\n      tvItem {\n        ... on Episode {\n          id\n          episode_number\n          season {\n            id\n            season_number\n          }\n        }\n        ... on Season {\n          id\n          season_number\n        }\n      }\n    }\n  }\n"]);return L=function(){return e},e}function _(){var e=Object(g.a)(["\n  mutation AddWatched(\n    $itemId: ID!\n    $itemType: ItemType!\n    $createdAt: Float!\n    $rating: RatingInput\n    $review: ReviewInput\n    $tvItemId: ID\n    $tvItemType: TvItemType\n    $autoTrackedId: ID\n  ) {\n    addWatched(\n      itemId: $itemId\n      itemType: $itemType\n      createdAt: $createdAt\n      rating: $rating\n      review: $review\n      tvItemId: $tvItemId\n      tvItemType: $tvItemType\n      autoTrackedId: $autoTrackedId\n    ) {\n      id\n      itemType\n      createdAt\n      rating {\n        id\n        value\n      }\n      review {\n        id\n        body\n      }\n      tvItemType\n      tvItem {\n        ... on Episode {\n          id\n          episode_number\n          season {\n            id\n            season_number\n          }\n        }\n        ... on Season {\n          id\n          season_number\n        }\n      }\n    }\n  }\n"]);return _=function(){return e},e}function M(){var e=Object(g.a)(["\n  mutation Logout {\n    logout @client\n  }\n"]);return M=function(){return e},e}function P(){var e=Object(g.a)(["\n  mutation Register($name: String!, $email: String!, $password: String!) {\n    register(name: $name, email: $email, password: $password) {\n      token\n      user {\n        id\n        name\n        email\n        createdAt\n        updatedAt\n        settings {\n          general {\n            autoConvert\n          }\n          extension {\n            autoTrack\n            minLengthSeconds\n            blacklist\n          }\n        }\n      }\n    }\n  }\n"]);return P=function(){return e},e}function W(){var e=Object(g.a)(["\n  mutation Login($email: String!, $password: String!) {\n    login(email: $email, password: $password) {\n      token\n      user {\n        id\n        name\n        email\n        createdAt\n        updatedAt\n        settings {\n          general {\n            autoConvert\n          }\n          extension {\n            autoTrack\n            minLengthSeconds\n            blacklist\n          }\n        }\n      }\n    }\n  }\n"]);return W=function(){return e},e}function q(){var e=Object(g.a)(["\n  fragment SeasonProps on Season {\n    id\n    name\n    overview\n    episode_count\n    air_date\n    poster_path\n    season_number\n    episodes {\n      id\n      name\n      overview\n      episode_number\n      air_date\n      vote_average\n      vote_count\n    }\n  }\n"]);return q=function(){return e},e}function F(){var e=Object(g.a)(["\n  fragment WatchedCursorWithItemsProps on WatchedCursor {\n    cursor\n    hasMore\n    watched {\n      ...WatchedProps\n      ...WatchedItemProps\n    }\n  }\n  ","\n  ","\n"]);return F=function(){return e},e}function z(){var e=Object(g.a)(["\n  fragment WatchedItemProps on Watched {\n    itemType\n    item {\n      ...ItemData\n    }\n  }\n  ","\n"]);return z=function(){return e},e}function Q(){var e=Object(g.a)(["\n  fragment ItemData on Item {\n    ... on Movie {\n      id\n      title\n      release_date\n      poster_path\n      backdrop_path\n    }\n    ... on Tv {\n      id\n      name\n      first_air_date\n      poster_path\n      backdrop_path\n    }\n  }\n"]);return Q=function(){return e},e}function Y(){var e=Object(g.a)(["\n  fragment WatchedCursorProps on WatchedCursor {\n    cursor\n    hasMore\n    watched {\n      ...WatchedProps\n    }\n  }\n  ","\n"]);return Y=function(){return e},e}function B(){var e=Object(g.a)(["\n  fragment WatchedProps on Watched {\n    id\n    createdAt\n    tvItemType\n    tvItem {\n      ...WatchedTvItemProps\n    }\n    rating {\n      id\n      value\n    }\n    review {\n      id\n      body\n    }\n    user {\n      id\n      name\n    }\n  }\n  ","\n"]);return B=function(){return e},e}function G(){var e=Object(g.a)(["\n  fragment WatchedTvItemProps on TvItem {\n    ... on Episode {\n      id\n      episode_number\n      season {\n        id\n        season_number\n      }\n    }\n    ... on Season {\n      id\n      season_number\n    }\n  }\n"]);return G=function(){return e},e}!function(e){e.Movie="Movie",e.Tv="Tv"}(a||(a={})),function(e){e.Season="Season",e.Episode="Episode"}(r||(r={})),function(e){e.Movie="Movie",e.Tv="Tv"}(i||(i={})),function(e){e.Public="PUBLIC",e.Private="PRIVATE"}(l||(l={}));var V=Object(v.gql)(G()),H=Object(v.gql)(B(),V),U=Object(v.gql)(Y(),H),Z=Object(v.gql)(Q()),J=Object(v.gql)(z(),Z),K=Object(v.gql)(F(),H,J),X=Object(v.gql)(q()),ee=Object(v.gql)(W());var te=Object(v.gql)(P());var ne=Object(v.gql)(M());var ae=Object(v.gql)(_());function re(e){return v.useMutation(ae,e)}var ie=Object(v.gql)(L());function le(e){return v.useMutation(ie,e)}var ce=Object(v.gql)(D());var oe=Object(v.gql)(R());var se=Object(v.gql)($());var ue=Object(v.gql)(A());var de=Object(v.gql)(S());function me(e){return v.useQuery(de,e)}var ve=Object(v.gql)(N());var pe=Object(v.gql)(C(),K);function fe(e){return v.useQuery(pe,e)}var Ee=Object(v.gql)(j(),U);function ge(e){return v.useQuery(Ee,e)}var he=Object(v.gql)(x(),X,U);function be(e){return v.useQuery(he,e)}var we=Object(v.gql)(k(),H,J);var ye=Object(v.gql)(T(),K);function Ie(e){return v.useQuery(ye,e)}var Oe=Object(v.gql)(O(),V);var Te=Object(v.gql)(I());var ke=Object(v.gql)(y(),Z,V);var xe=Object(v.gql)(w(),Z,V);var je=Object(v.gql)(b(),X);var Ce=Object(v.gql)(h());function Ne(e){var t=e.redirectTo,n=void 0===t?"/login":t,a=e.redirectComponent,r=Object(E.a)(e,["redirectTo","redirectComponent"]),i=me().data;return(null===i||void 0===i?void 0:i.auth)?s.createElement(f.b,r):a?s.createElement(f.b,Object.assign({},r,{component:a})):s.createElement(f.a,{to:n})}var Se=n(10),Ae=n(239),$e=n(25),Re=n(69),De=n(61);function Le(){return(Le=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function _e(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Me,Pe,We=u.a.createElement("style",null,"tspan { white-space:pre }.shp0 { fill: #ffffff;stroke: #000000;stroke-width: 3 } .shp1 { fill: #000000 } .shp2 { fill: #ffffff } "),qe=u.a.createElement("path",{className:"shp0",d:"M14.5 2L14.5 2C21.41 2 27 7.59 27 14.5L27 33.5C27 40.41 21.41 46 14.5 46L14.5 46C7.59 46 2 40.41 2 33.5L2 14.5C2 7.59 7.59 2 14.5 2Z"}),Fe=u.a.createElement("path",{className:"shp0",d:"M41.5 2L41.5 2C48.41 2 54 7.59 54 14.5L54 33.5C54 40.41 48.41 46 41.5 46L41.5 46C34.59 46 29 40.41 29 33.5L29 14.5C29 7.59 34.59 2 41.5 2Z"}),ze=u.a.createElement("path",{className:"shp1",d:"M44 38C39.02 38 35 33.98 35 29C35 24.02 39.02 20 44 20C48.98 20 53 24.02 53 29C53 33.98 48.98 38 44 38Z"}),Qe=u.a.createElement("path",{className:"shp2",d:"M40.5 28C39.12 28 38 26.88 38 25.5C38 24.12 39.12 23 40.5 23C41.88 23 43 24.12 43 25.5C43 26.88 41.88 28 40.5 28Z"}),Ye=u.a.createElement("path",{className:"shp1",d:"M17 38C12.02 38 8 33.98 8 29C8 24.02 12.02 20 17 20C21.98 20 26 24.02 26 29C26 33.98 21.98 38 17 38Z"}),Be=u.a.createElement("path",{className:"shp2",d:"M13.5 28C12.12 28 11 26.88 11 25.5C11 24.12 12.12 23 13.5 23C14.88 23 16 24.12 16 25.5C16 26.88 14.88 28 13.5 28Z"}),Ge=function(e){var t=e.svgRef,n=e.title,a=_e(e,["svgRef","title"]);return u.a.createElement("svg",Le({viewBox:"0 0 56 48",ref:t},a),n?u.a.createElement("title",null,n):null,We,qe,Fe,ze,Qe,Ye,Be)},Ve=u.a.forwardRef((function(e,t){return u.a.createElement(Ge,Le({svgRef:t},e))}));n.p;!function(e){e[e.text=0]="text",e[e.textLarge=1]="textLarge",e[e.logo=2]="logo",e[e.large=3]="large"}(Pe||(Pe={}));var He=(Me={},Object(De.a)(Me,Pe.text,[14,12,"0 1px"]),Object(De.a)(Me,Pe.textLarge,[16,14,"1px 1px 0 2px"]),Object(De.a)(Me,Pe.logo,[18,16,"1px 1px 0"]),Object(De.a)(Me,Pe.large,[24,19,"1px 1px 0 2px"]),Me);function Ue(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{size:Pe.logo},t=e.size,n=Object(Se.a)(He[t],3),a=n[0],r=n[1],i=n[2];return u.a.createElement("div",{className:"seenit-logo",style:{fontSize:a}},"S",u.a.createElement(Ve,{className:"logo-eyes",style:{height:r,padding:i}}),"N\xa0IT")}Ue.defaultProps={size:Pe.logo};var Ze=n(242),Je=n(29);var Ke=function(e,t){var n=e.label,a=e.item,r=t.handleClick,i=t.modifiers;return i.matchesPredicate?s.createElement(Ae.s,{active:i.active,key:a.id,text:n,onClick:r}):null},Xe=function(e){e.selected;var t,n=e.setSelected,a=s.useState(""),r=Object(Se.a)(a,2),i=r[0],l=r[1],c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,a=Object(s.useRef)(),r=Object(s.useRef)(e),i=Object(s.useRef)(n),l=Object(s.useRef)();r.current=e,i.current=n;var c=Object(s.useCallback)((function(){a.current&&clearTimeout(a.current),a.current=void 0}),[]),o=Object(s.useCallback)((function(){for(var e=arguments.length,n=new Array(e),c=0;c<e;c++)n[c]=arguments[c];var o;(l.current=n,a.current)||((null===(o=i.current)||void 0===o?void 0:o.leading)?(r.current.apply(r,Object(Je.a)(l.current)),a.current=setTimeout((function(){a.current=void 0}),t)):a.current=setTimeout((function(){r.current.apply(r,Object(Je.a)(l.current)),a.current=void 0}),t))}),[t]),u=Object(s.useCallback)((function(){a&&(r.current.apply(r,Object(Je.a)(l.current)),c())}),[c]);return Object(s.useEffect)((function(){return c}),[c]),{callback:o,cancel:c,callPending:u}}((function(e){return l(e)}),1e3).callback,o=i.length>2,u=(t={variables:{title:i},skip:i.length<3},v.useQuery(Te,t)),d=u.data&&u.data.searchContent?u.data.searchContent.reduce((function(e,t){return e.concat({label:"".concat(t.title," (").concat((t.release_date||"?").split("-")[0],")"),value:t.id,item:t})}),[]):[];return s.createElement(Ze.a,{itemRenderer:Ke,items:d,onQueryChange:c,onItemSelect:function(e){var t=e.item;return n(t)},noResults:s.createElement(Ae.s,{disabled:!0,text:o?u.loading?"Loading...":"Got nothing :(":"Type more to start seach"}),initialContent:s.createElement(Ae.s,{disabled:!0,text:"Type more to start seach"}),inputValueRenderer:function(e){return e.label},popoverProps:{minimal:!0,fill:!0,usePortal:!1,position:Ae.y.BOTTOM},inputProps:{rightElement:(null===u||void 0===u?void 0:u.loading)?s.createElement(Ae.z,{size:16}):void 0},className:"select-popover-centered"})};function et(){var e=Object(f.g)();return s.createElement(Xe,{setSelected:function(t){var n=t.type,a=t.id;e.push("/".concat(null===n||void 0===n?void 0:n.toLowerCase(),"/").concat(a))}})}var tt=Xe;function nt(){var e,t=v.useMutation(ne,e),n=Object(Se.a)(t,1)[0],a=me().data;return(null===a||void 0===a?void 0:a.auth)?u.a.createElement(Ae.w,{content:u.a.createElement(Ae.q,null,u.a.createElement(p.b,{to:"/profile/".concat(a.auth.name)},u.a.createElement(Ae.s,{tagName:"span",text:"Profile"})),u.a.createElement(p.b,{to:"/settings"},u.a.createElement(Ae.a,{minimal:!0},"Settings")),u.a.createElement(Ae.s,{tagName:"span",text:"Logout",onClick:function(){return n()}})),position:$e.a.BOTTOM},a.auth.name):u.a.createElement(p.b,{to:"/login"},u.a.createElement(Ae.a,{minimal:!0,icon:"user"},"Login"))}function at(){return u.a.createElement("div",{className:"navigation-container"},u.a.createElement(Ae.t,{fixedToTop:!0},u.a.createElement(Ae.t.Group,{align:Re.a.LEFT},u.a.createElement(Ae.t.Heading,null,u.a.createElement(p.c,{to:"/"},u.a.createElement(Ue,null))),u.a.createElement(Ae.t.Divider,null)),u.a.createElement(Ae.t.Group,{align:Re.a.RIGHT},u.a.createElement(et,null),u.a.createElement(Ae.t.Divider,null),u.a.createElement(nt,null))))}var rt=n(28),it=n(56);function lt(e){var t=window.localStorage.getItem("seenit-web-"+e);if(!t)return null;try{return JSON.parse(t)}catch(n){return t}}function ct(e,t){return t?window.localStorage.setItem("seenit-web-"+e,"string"===typeof t?t:JSON.stringify(t)):window.localStorage.removeItem("seenit-web-"+e)}function ot(){var e=Object(g.a)(["\n      {\n        auth\n      }\n    "]);return ot=function(){return e},e}var st=function(e,t,n){ct("token",n||null),ct("userData",t||null),e.writeQuery({query:Object(v.gql)(ot()),data:{auth:t||null}})};function ut(){var e,t=Object(f.g)(),n=u.a.useState({email:"",password:"",name:""}),a=Object(Se.a)(n,2),r=a[0],i=a[1],l=u.a.useState(!0),c=Object(Se.a)(l,2),s=c[0],d=c[1],m={variables:r,update:function(e,t){var n=t.data;if(n){var a="login"in n?n.login:n.register,r=a.token,i=a.user;st(e,i,r),document.dispatchEvent(new CustomEvent("seenit-login"))}}},p=(e=m,v.useMutation(ee,e)),E=Object(Se.a)(p,1)[0],g=function(e){return v.useMutation(te,e)}(m),h=Object(Se.a)(g,1)[0],b=s?E:h;return u.a.createElement("form",{onSubmit:function(e){return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e.preventDefault(),n.next=3,o.a.awrap(b());case 3:t.push("/");case 4:case"end":return n.stop()}}))}},!s&&u.a.createElement(Ae.j,{label:"Name",labelFor:"name-input"},u.a.createElement(Ae.p,{id:"name-input",large:!0,leftIcon:"user",onChange:function(e){return i(Object(rt.a)({},r,{name:e.target.value}))},placeholder:"John Doe",value:r.name})),u.a.createElement(Ae.j,{label:"Email",labelFor:"email-input"},u.a.createElement(Ae.p,{id:"email-input",large:!0,type:"email",leftIcon:"envelope",onChange:function(e){return i(Object(rt.a)({},r,{email:e.target.value}))},placeholder:"you@mail.com",value:r.email})),u.a.createElement(Ae.j,{label:"Password",labelFor:"password-input"},u.a.createElement(Ae.p,{id:"password-input",large:!0,type:"password",leftIcon:"lock",onChange:function(e){return i(Object(rt.a)({},r,{password:e.target.value}))},placeholder:"Your password",value:r.password})),u.a.createElement("div",{className:"flex flex-between"},u.a.createElement(Ae.a,{type:"submit",intent:it.a.PRIMARY},s?"Login":"Register"),u.a.createElement(Ae.a,{type:"button",onClick:function(){return d(!s)}},s?"Need to create an account?":"Already have an account?")))}var dt=n(136),mt=n.n(dt),vt=n(137),pt=n.n(vt);function ft(){return u.a.createElement("div",{className:"hero-box"},u.a.createElement(Ae.k,null,"Automatically track what you've watched"),u.a.createElement(Ae.l,{className:"pt-3"},"Start tracking"),u.a.createElement("div",{className:"py-4"},u.a.createElement(Ae.a,{large:!0,fill:!0,className:"my-4"},u.a.createElement(p.b,{to:"/login"},"Join seen it")),u.a.createElement(Ae.a,{large:!0,fill:!0,className:"my-4"},u.a.createElement(p.b,{to:"/setup"},"Download for your used platforms"))),u.a.createElement("div",null,u.a.createElement(Ae.m,{className:"pb-2"},"Currently works with"),u.a.createElement("div",null,u.a.createElement("img",{className:"mx-3",style:{width:48},alt:"Chrome",src:mt.a}),u.a.createElement("img",{className:"mx-3",style:{height:48},alt:"VLC",src:pt.a}))))}var Et=n(138),gt=n(50),ht=n(243),bt=n(87);function wt(e){var t=e.value,n=e.className,a=void 0===n?"":n,r=e.max,i=t/((void 0===r?10:r)/5);return u.a.createElement(bt.a,{readonly:!0,className:"rating "+a,initialRating:i,fractions:2,fullSymbol:u.a.createElement(Ae.o,{icon:gt.a.STAR,color:"gold"}),emptySymbol:u.a.createElement(Ae.o,{icon:gt.a.STAR_EMPTY,color:"gold"})})}function yt(e){var t=e.children,n=e.loadMore,a=e.loading,r=e.hasMore,i=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"200px",r=Object(s.useRef)(null);return Object(s.useEffect)((function(){var i=new IntersectionObserver((function(a){Object(Se.a)(a,1)[0].isIntersecting&&!t&&n&&e()}),{rootMargin:a});return r&&r.current&&i.observe(r.current),function(){return i.disconnect()}}),[t,e,a,n]),r}(n,a,r);return u.a.createElement(u.a.Fragment,null,t,!a&&r&&u.a.createElement("div",{ref:i},"a"))}function It(e){return e?"season_number"in e?"S".concat(e.season_number):"S".concat(e.season.season_number,"E").concat(e.episode_number):null}var Ot=function(e,t){return function(){return e({variables:t,updateQuery:function(e,t){var n=t.fetchMoreResult;if(!(null===n||void 0===n?void 0:n.user))return e;var a=e.user.watched.watched||[],r=n.user.watched.watched||[];return{user:Object(rt.a)({},n.user,{watched:Object(rt.a)({},n.user.watched,{watched:[].concat(Object(Je.a)(a),Object(Je.a)(r))})})}}})}};function Tt(){var e,t=Object(s.useState)({style:void 0,targetIndex:-1}),n=Object(Se.a)(t,2),r=n[0],i=n[1],l=Object(f.i)().name,c=Object(f.g)(),o=fe({variables:{name:l},notifyOnNetworkStatusChange:!0}),d=o.loading,m=o.data,v=o.fetchMore;if(!(null===m||void 0===m?void 0:null===(e=m.user)||void 0===e?void 0:e.watched))return null;var p=m.user.watched,E=p.hasMore,g=p.cursor,h=p.watched,b=h[r.targetIndex]||null;return u.a.createElement(yt,{loading:d,hasMore:E,loadMore:Ot(v,{name:l,cursor:g})},u.a.createElement("div",{className:"grid grid-card"},h.map((function(e,t){var n,r=e.id,l=e.item,c=e.itemType,o=e.rating,s=e.review,d=e.tvItem,m=e.createdAt;return l?(n=c===a.Movie?l.title:l.name,u.a.createElement(Ae.d,{key:r,className:"card-watched",onClick:function(e){var n=e.currentTarget.getBoundingClientRect();i({style:{left:n.left,top:n.top,width:n.width,height:n.height,position:"fixed"},targetIndex:t})}},u.a.createElement("div",null,u.a.createElement("div",{style:{position:"relative"}},u.a.createElement("img",{width:"300",height:"200",className:"img-responsive",src:"https://image.tmdb.org/t/p/w1280".concat(l.poster_path),style:{position:"relative"},alt:""})),u.a.createElement("div",{className:"card-watched-footer"},o&&u.a.createElement(wt,{value:o.value}),s&&s.body&&u.a.createElement(Ae.o,{icon:gt.a.COMMENT,color:"gold"})),u.a.createElement("div",{className:"p-3 text-left title"},u.a.createElement("div",{className:"flex flex-content-between flex-items-center"},u.a.createElement("strong",{className:"bp3-text-large bp3-text-overflow-ellipsis pr-2"},n),u.a.createElement("div",null,It(d))),u.a.createElement("p",{className:"bp3-text-small card-watched-muted"},Object(ht.a)(m,Date.now(),{addSuffix:!0})))))):null})),b&&u.a.createElement(Et.Spring,{config:{velocity:120,friction:16,clamp:!0},from:r.style,to:{left:0,top:50,width:window.innerWidth,height:window.innerHeight},onRest:function(){return c.push("/movie/".concat(b.item.id,"/watched/").concat(b.id))}},(function(e){return u.a.createElement("div",{style:e},u.a.createElement("img",{width:"300",height:"200",className:"img-responsive",src:"https://image.tmdb.org/t/p/w1280".concat(b.item.poster_path),style:{position:"relative",maxHeight:300,objectFit:"cover"},alt:""}),u.a.createElement("div",{style:{height:"100%",backgroundColor:"#0C1821"}}))}))))}function kt(){return u.a.createElement("div",null,"Download and setup the platform")}var xt=n(3),jt=n(240);function Ct(e){var t=e.date,n=e.baseDate,a=void 0===n?Date.now():n,r=e.options,i=void 0===r?{addSuffix:!0}:r;return u.a.createElement(Ae.E,{content:Object(jt.a)(t,"yyyy MMM dd, HH:mm")},Object(ht.a)(t,a,i))}function Nt(e){var t=e.type,n=e.item,r=e.date,i=e.tvItem,l="title"in n?n.title:n.name,c=t===a.Movie?"movie":"tv";return u.a.createElement(p.b,{to:"/".concat(c,"/").concat(n.id)},u.a.createElement(Ae.d,{className:"card-watched"},u.a.createElement("div",{style:{position:"relative"}},u.a.createElement("img",{width:"300",height:"200",className:"img-responsive",src:"https://image.tmdb.org/t/p/w1280".concat(n.poster_path),style:{position:"relative"},alt:""})),u.a.createElement("div",{className:"p-3 text-left title"},u.a.createElement("div",{className:"flex flex-content-between flex-items-center"},u.a.createElement("strong",{className:"bp3-text-large bp3-text-overflow-ellipsis pr-2"},l),u.a.createElement("div",null,It(i))),r&&u.a.createElement("p",{className:"bp3-text-small card-watched-muted"},u.a.createElement(Ct,{date:r})))))}var St,At=n(5),$t=n.n(At),Rt=document.getElementById("root")||void 0;function Dt(e){var t=e.canEscapeKeyCancel,n=void 0!==t&&t,a=e.canOutsideClickCancel,r=void 0!==a&&a,i=e.confirmButtonText,l=void 0===i?"Ok":i,c=e.cancelButtonText,o=e.onConfirm,s=e.onCancel,d=e.isLoading,m=void 0!==d&&d,v=e.className,p=void 0===v?"":v,f=e.intent,g=e.icon,h=e.children,b=Object(E.a)(e,["canEscapeKeyCancel","canOutsideClickCancel","confirmButtonText","cancelButtonText","onConfirm","onCancel","isLoading","className","intent","icon","children"]);return u.a.createElement(Ae.h,Object.assign({},b,{portalContainer:Rt,className:$t()(xt.a.ALERT,p),canEscapeKeyClose:n&&!m,canOutsideClickClose:r&&!m,onClose:s}),u.a.createElement("div",{className:xt.a.ALERT_BODY},u.a.createElement(Ae.o,{icon:g,iconSize:40,intent:f}),u.a.createElement("div",{className:xt.a.ALERT_CONTENTS},h)),u.a.createElement("div",{className:xt.a.ALERT_FOOTER},u.a.createElement(Ae.a,{intent:f,text:l,onClick:o,loading:m,disabled:m}),c&&u.a.createElement(Ae.a,{text:c,onClick:s,disabled:m})))}function Lt(e){var t=e.title,n=e.isOpen,a=e.isLoading,r=e.onCancel,i=e.onConfirm;return u.a.createElement(Dt,{cancelButtonText:"Cancel",confirmButtonText:"Remove",icon:"trash",intent:it.a.DANGER,isOpen:n||!1,isLoading:a,onCancel:r,onConfirm:i},t)}function _t(e){var t,n=e.id,a=e.createdAt,r=e.meta,i=e.item,l=e.tvItem,c=e.isSelected,o=e.onSelect,s=e.onDeselect,d=e.onSave,m=e.onRemove,v=i?"title"in i?i.title:i.name:"",E=Object(f.h)(),g=new URLSearchParams(E.search);return g.set(St.EditingAutoTracked,n),u.a.createElement(Ae.d,{className:"card-watched fill-container ".concat(c?"selected":""),elevation:c?4:void 0,onClick:c?s:o},i&&u.a.createElement(u.a.Fragment,null,u.a.createElement("div",null,u.a.createElement("img",{width:"300",height:"200",className:"img-responsive",src:"https://image.tmdb.org/t/p/w342".concat(i.poster_path),alt:"".concat(v," poster")})),u.a.createElement("div",{className:"p-3 title"},u.a.createElement("div",{className:"flex flex-content-between flex-items-center"},u.a.createElement("strong",{className:"bp3-text-large bp3-text-overflow-ellipsis pr-2"},v),u.a.createElement("div",null,It(l))),a&&u.a.createElement("p",{className:"bp3-text-small card-watched-muted"},u.a.createElement(Ct,{date:a})))),!i&&u.a.createElement(Ae.u,{icon:"help",title:"Couldn't find item",description:u.a.createElement("div",{className:"text-left px-2",style:{width:"100%"}},u.a.createElement("div",{className:"mb-3"},u.a.createElement("strong",null,"Here's what we know:")),u.a.createElement("div",{className:"mb-1"},"Watched ",u.a.createElement(Ct,{date:a})),r.title&&u.a.createElement("div",{className:"mb-1"},u.a.createElement("span",null,"Title read as "),u.a.createElement(Ae.f,null,r.title)," "),r.tvData&&u.a.createElement("div",{className:"mb-1"},u.a.createElement("span",null,"TV info - "),r.tvData.season&&u.a.createElement("span",null,"S",r.tvData.season),r.tvData.episode&&u.a.createElement("span",null,"E",r.tvData.episode)),r.provider&&u.a.createElement("div",{className:"mb-1"},u.a.createElement("span",null,"Tracked on ",r.provider,", from"),u.a.createElement("br",null),r.url&&u.a.createElement(Ae.f,{className:"mt-1",style:{display:"inline-block",textOverflow:"ellipsis",whiteSpace:"nowrap",width:"100%",overflow:"hidden"}},r.url),r.filename&&u.a.createElement(Ae.f,{className:"mt-1",style:{display:"inline-block",textOverflow:"ellipsis",whiteSpace:"nowrap",width:"100%",overflow:"hidden"}},r.filename)))}),u.a.createElement(Ae.b,{fill:!0,minimal:!0,onClick:function(e){e.stopPropagation(),null===t||void 0===t||t(e)}},i&&u.a.createElement(Ae.a,{disabled:!i,icon:"tick",onClick:d},"Save"),u.a.createElement(p.b,{to:{search:g.toString()},replace:!0,className:"bp3-button"},u.a.createElement(Ae.o,{icon:"edit",className:"mr-2"}),u.a.createElement("span",null,"Edit")),u.a.createElement(Ae.a,{icon:"trash",onClick:m},"Remove")))}!function(e){e.EditingAutoTracked="editing-auto-tracked",e.EditingWatched="editing-watched"}(St||(St={}));var Mt=Ae.D.create({position:$e.a.TOP_RIGHT});function Pt(){var e,t,n,a,r=me().data,i=null===r||void 0===r?void 0:r.auth,l=Ie({variables:{userId:null===r||void 0===r?void 0:null===(e=r.auth)||void 0===e?void 0:e.id}}).data,c=(a={variables:{userId:(null===r||void 0===r?void 0:null===(t=r.auth)||void 0===t?void 0:t.id)||""}},v.useQuery(ke,a)).data,d=fe({variables:{id:null===i||void 0===i?void 0:i.id}}).data,m=function(e){return v.useMutation(oe,e)}({refetchQueries:["AutoTrackedList"]}),p=Object(Se.a)(m,2),f=p[0],E=p[1].loading,g=function(e){return v.useMutation(se,e)}({refetchQueries:["AutoTrackedList"]}),h=Object(Se.a)(g,1)[0],b=Object(s.useState)([]),w=Object(Se.a)(b,2),y=w[0],I=w[1],O=Object(s.useState)(),T=Object(Se.a)(O,2),k=T[0],x=T[1];return i&&(null===d||void 0===d?void 0:null===(n=d.user)||void 0===n?void 0:n.watched)?u.a.createElement(u.a.Fragment,null,u.a.createElement("div",null,u.a.createElement("div",{className:"p-4 pb-1"},u.a.createElement(Ae.l,null,"Automatically tracked shows"),u.a.createElement("div",{className:"flex flex-items-center"},u.a.createElement(Ae.e,{className:"m-0 py-2",checked:y.length===(null===c||void 0===c?void 0:c.autoTrackedList.autoTracked.length),indeterminate:!!y.length&&y.length<((null===c||void 0===c?void 0:c.autoTrackedList.autoTracked.length)||0),label:y.length?"".concat(y.length," Selected"):"Select all",onChange:function(){return I(y.length===(null===c||void 0===c?void 0:c.autoTrackedList.autoTracked.length)?[]:(null===c||void 0===c?void 0:c.autoTrackedList.autoTracked.map((function(e){return e.id})))||[])}}),!!y.length&&u.a.createElement(u.a.Fragment,null,u.a.createElement(Ae.a,{small:!0,className:"ml-2",icon:"tick",onClick:function(){var e,t;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e=y.filter((function(e){var t=null===c||void 0===c?void 0:c.autoTrackedList.autoTracked.find((function(t){return t.id===e}));return t&&t.item})),t=e.length!==y.length,n.next=4,o.a.awrap(h({variables:{ids:e}}));case 4:t&&Mt.show({message:"Couldn't save items without shows",intent:it.a.WARNING}),I([]);case 6:case"end":return n.stop()}}))}},"Save"),u.a.createElement(Ae.a,{small:!0,className:"ml-2",icon:"trash",onClick:function(){return x({title:u.a.createElement("p",null,"Are you sure you want to remove the selected items?"),onConfirm:function(){return o.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.awrap(f({variables:{ids:y}}));case 2:I([]),x(null);case 4:case"end":return e.stop()}}))}})}},"Remove")))),u.a.createElement("div",{className:"grid grid-card"},null===c||void 0===c?void 0:c.autoTrackedList.autoTracked.map((function(e,t,n){var a=e.id,r=e.createdAt,i=e.meta,l=e.item,c=e.tvItem;return u.a.createElement("div",{key:a,className:xt.a.INTENT_PRIMARY,style:{position:"relative"}},y.includes(a)&&u.a.createElement(Ae.o,{icon:"tick-circle",intent:it.a.PRIMARY,iconSize:16,style:{position:"absolute",left:-8,top:-8,zIndex:1}}),u.a.createElement(_t,{id:a,createdAt:r,meta:i,item:l,tvItem:c,isSelected:y.includes(a),onSelect:function(){return I([].concat(Object(Je.a)(y),[a]))},onDeselect:function(){return I(y.filter((function(e){return e!==a})))},onSave:function(){return h({variables:{ids:[a]}})},onRemove:function(){return x({title:u.a.createElement("p",null,"Are you sure you want to remove the tracked item?"),onConfirm:function(){return o.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.awrap(f({variables:{ids:[a]}}));case 2:x(null);case 3:case"end":return e.stop()}}))}})}}))}))),u.a.createElement("div",{className:"p-4 pb-1"},u.a.createElement(Ae.l,null,"Your last seen")),u.a.createElement("div",{className:"grid grid-card"},null===l||void 0===l?void 0:l.watches.watched.map((function(e){var t=e.id,n=e.itemType,a=e.item,r=e.createdAt,i=e.tvItem;return u.a.createElement(Nt,{key:t,type:n,item:a,tvItem:i||void 0,date:r})})))),k&&u.a.createElement(Lt,{isOpen:!!k,isLoading:E,title:k.title,onConfirm:k.onConfirm,onCancel:function(){return x(null)}})):null}var Wt=function(e,t){return t?{watches:Object(rt.a)({},t.watches,{watched:[].concat(Object(Je.a)(e.watches.watched),Object(Je.a)(t.watches.watched))})}:e},qt=function(e,t){return t?{reviews:Object(rt.a)({},t.reviews,{reviews:[].concat(Object(Je.a)(e.reviews.reviews),Object(Je.a)(t.reviews.reviews))})}:e},Ft=function(e,t,n){return function(){return e({variables:t,updateQuery:function(e,t){var a=t.fetchMoreResult;return n(e,a)}})}};function zt(e){var t=e.review,n=e.user,a=e.rating,r=e.createdAt;return u.a.createElement("div",null,u.a.createElement(p.b,{to:"/profile/".concat(n.name)},n.name),"\xa0",u.a.createElement("span",{className:"bp3-text-muted"},Object(ht.a)(r,Date.now(),{addSuffix:!0})),a&&u.a.createElement(wt,{className:"ml-2",value:a}),u.a.createElement("p",null,t))}function Qt(e){var t,n={itemId:e.itemId,tvItemId:e.tvItemId},a=(t={variables:n},v.useQuery(Oe,t)),r=a.data,i=a.loading,l=a.fetchMore;if(i)return u.a.createElement(Ae.z,null);if(!(null===r||void 0===r?void 0:r.reviews))return null;var c=null===r||void 0===r?void 0:r.reviews,o=c.reviews,s=c.hasMore,d=c.cursor;return o.length?u.a.createElement(u.a.Fragment,null,o.map((function(e){var t=e.id,n=e.body,a=e.watched,r=a.rating,i=a.user,l=a.createdAt;return u.a.createElement(zt,{key:t,review:n,user:i,createdAt:l,rating:null===r||void 0===r?void 0:r.value})})),s&&u.a.createElement(Ae.a,{text:"Show more",onClick:Ft(l,Object(rt.a)({},n,{cursor:d}),qt)})):u.a.createElement(Ae.u,{icon:"chat",title:"No reviews yet"})}var Yt=n(55);function Bt(e){var t,n=e.watched,a=e.onClickEdit,r=e.className,i=n.id,l=n.createdAt,c=n.rating,d=n.review,m=n.tvItem,p=Object(s.useState)({dialogOpen:!1,isLoading:!1}),f=Object(Se.a)(p,2),E=f[0],g=f[1],h=(t={update:function(e,t){var n=t.data,a=null===n||void 0===n?void 0:n.removeWatched,r=e.identify({id:a,__typename:"Watched"});a&&r&&(e.evict({id:r}),e.gc())}},v.useMutation(ce,t)),b=Object(Se.a)(h,2),w=b[0],y=b[1].loading;return u.a.createElement(Ae.d,{elevation:Yt.a.ONE,className:r},u.a.createElement("div",{className:"flex flex-content-between flex-items-center mb-2"},u.a.createElement("div",null,u.a.createElement("span",null,"Seen "),m&&u.a.createElement("span",null,It(m)," "),u.a.createElement("span",{className:"bp3-text-muted mr-2"},Object(ht.a)(l,Date.now(),{addSuffix:!0})),c&&u.a.createElement(wt,{value:c.value})),u.a.createElement(Ae.b,null,u.a.createElement(Ae.a,{icon:"edit",small:!0,onClick:function(){return a(n)}},"Edit"),u.a.createElement(Ae.a,{small:!0,icon:"trash",intent:it.a.DANGER,loading:y,onClick:function(){return g({dialogOpen:!0,isLoading:!1})}},"Remove"),u.a.createElement(Dt,{cancelButtonText:"Cancel",confirmButtonText:"Remove",icon:"trash",intent:it.a.DANGER,isOpen:E.dialogOpen,isLoading:E.isLoading,onCancel:function(){return g({dialogOpen:!1,isLoading:!1})},onConfirm:function(){return o.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(E.dialogOpen){e.next=2;break}return e.abrupt("return");case 2:return g(Object(rt.a)({},E,{isLoading:!0})),e.next=5,o.a.awrap(w({variables:{itemId:i}}));case 5:case"end":return e.stop()}}))}},u.a.createElement("p",null,"Are you sure you want to remove this watched entry?",u.a.createElement("br",null),u.a.createElement("br",null),u.a.createElement("i",null,"This will also remove the associated rating and review if any. Removing cannot be undone."))))),d&&u.a.createElement("p",null,d.body),!d&&u.a.createElement("p",{className:"bp3-text-muted"},"No review"))}function Gt(e){var t=e.itemId,n=e.userId,a=e.onEdit,r={userId:n,itemId:t},i=Ie({variables:r,skip:!n}),l=i.data,c=i.loading,o=i.fetchMore;if(c)return u.a.createElement(Ae.z,null);if(!(null===l||void 0===l?void 0:l.watches))return null;var s=l.watches,d=s.watched,m=s.hasMore,v=s.cursor;return d.length?u.a.createElement(u.a.Fragment,null,d.map((function(e){return u.a.createElement(Bt,{key:e.id,watched:e,onClickEdit:function(e){return a(e)}})})),m&&u.a.createElement(Ae.a,{text:"Show more",onClick:Ft(o,Object(rt.a)({},r,{cursor:v}),Wt)})):u.a.createElement(Ae.u,{icon:"film",title:"Not yet seen",description:"Have you seen it? Watch it or track it!"})}var Vt=n(60),Ht=n(241);function Ut(e){var t=e.value,n=e.onChange,a=e.className,r=void 0===a?"":a;return u.a.createElement(bt.a,{onChange:n,className:"rating "+r,initialRating:t,fractions:2,fullSymbol:u.a.createElement(Ae.o,{icon:gt.a.STAR,color:"gold",iconSize:Ae.o.SIZE_LARGE}),emptySymbol:u.a.createElement(Ae.o,{icon:gt.a.STAR_EMPTY,color:"gold",iconSize:Ae.o.SIZE_LARGE})})}function Zt(e){var t=e.item,n=e.onSubmit,a=e.isLoading,r=e.values,i=void 0===r?{review:"",createdAt:Date.now()}:r;return s.createElement(s.Fragment,null,s.createElement("div",{className:"flex p-3"},t.poster&&s.createElement("div",{className:"pr-3"},s.createElement("img",{src:"https://image.tmdb.org/t/p/w185".concat(t.poster),alt:"Poster for ".concat(t.title),className:"img-responsive"})),s.createElement(Vt.b,{enableReinitialize:!0,initialValues:i,onSubmit:n},(function(e){var t=e.values,n=e.handleChange,r=e.handleSubmit,i=e.setFieldValue;return s.createElement("form",{className:"flex-grow",onSubmit:r},s.createElement(Ae.j,{label:"Watched on",labelFor:"createdAt"},s.createElement(Ht.a,{popoverProps:{fill:!0},formatDate:function(e){return e.toLocaleString()},parseDate:function(e){return new Date(e)},placeholder:"M/D/YYYY",onChange:function(e){return i("createdAt",+new Date(e))},value:new Date(t.createdAt)})),s.createElement(Ae.j,{label:"Review",labelFor:"review"},s.createElement(Ae.C,{fill:!0,growVertically:!0,large:!0,name:"review",onChange:n,value:t.review,placeholder:"Any thoughts on what you watched?"})),s.createElement(Ae.j,{label:"Rating",labelFor:"rating"},s.createElement("div",{className:"flex flex-content-between flex-items-center"},s.createElement("div",null,s.createElement(Ut,{value:t.rating||0,className:"seen-rating",onChange:function(e){return i("rating",e)}})," ",s.createElement("span",null,t.rating||"?","/5")),t.rating&&s.createElement(Ae.a,{icon:"cross",intent:it.a.DANGER,minimal:!0,small:!0,onClick:function(){return i("rating",void 0)}}))),s.createElement(Ae.a,{type:"submit",large:!0,fill:!0,intent:it.a.PRIMARY,loading:a},"Add"))}))))}var Jt=function(e,t){return t.filter((function(t){var n=t.name,a=t.seasonName;return"".concat(n," ").concat(a).toLowerCase().includes(e.toLowerCase())}))},Kt=function(e,t){var n=t.handleClick,a=t.modifiers,r=t.query;return a.matchesPredicate?s.createElement(s.Fragment,{key:e.id},s.createElement(Ae.s,{active:a.active,text:e.name,label:e.seasonName||void 0,onClick:n}),!r&&e.lastSeasonEpisode&&!e.lastSeason&&s.createElement(Ae.r,null)):null};function Xt(e){var t,n=e.item,a=e.onSubmit,r=e.isLoading,i=e.values,l=void 0===i?{createdAt:Date.now(),review:""}:i,c=(t={variables:{itemId:n.id},skip:!!n.seasons},v.useQuery(je,t)),o=c.data,u=c.loading,d=function(e){return e.reduce((function(t,n,a){var r=n.season_number,i=n.episodes;return t.push.apply(t,Object(Je.a)(i.map((function(t,n){var l=t.id,c=t.name,o=t.episode_number;return{id:l,name:c,seasonName:r?"S".concat(r,"E").concat(o):"",value:{season:r,episode:o},lastSeasonEpisode:n+1===i.length,lastSeason:a+1===e.length}})))),t}),[])}(n.seasons||(null===o||void 0===o?void 0:o.seasons)||[]);return s.createElement("div",{className:"flex p-3"},n.poster&&s.createElement("div",{className:"pr-3"},s.createElement("img",{src:"https://image.tmdb.org/t/p/w185".concat(n.poster),alt:"Poster for ".concat(n.title),className:"img-responsive"})),s.createElement(Vt.b,{enableReinitialize:!0,initialValues:l,onSubmit:a},(function(e){var t=e.values,n=e.handleChange,a=e.handleSubmit,i=e.setFieldValue;return s.createElement("form",{className:"flex-grow",onSubmit:a},s.createElement(Ae.j,{label:"Watched on",labelFor:"createdAt"},s.createElement(Ht.a,{popoverProps:{fill:!0},formatDate:function(e){return e.toLocaleString()},parseDate:function(e){return new Date(e)},placeholder:"M/D/YYYY",onChange:function(e){return i("createdAt",+new Date(e))},value:new Date(t.createdAt)})),s.createElement(Ae.j,{label:"Episode",labelFor:"tvItemId",helperText:"Empty episode field indicates the whole show"},s.createElement(Ze.a,{selectedItem:d.find((function(e){return e.id===t.tvItemId}))||null,inputValueRenderer:function(e){var t=e.name,n=e.seasonName;return"".concat(t," - ").concat(n)},itemRenderer:Kt,items:d,itemListPredicate:Jt,onItemSelect:function(e){var t=e.id;return i("tvItemId",t)},noResults:s.createElement(Ae.s,{disabled:!0,text:"Got nothing :("}),popoverProps:{minimal:!0,fill:!0,usePortal:!1,position:Ae.y.BOTTOM},disabled:u,inputProps:{placeholder:"Select an episode",rightElement:u?s.createElement(Ae.E,{content:"Loading season data"},s.createElement(Ae.z,{size:16})):s.createElement(Ae.E,{content:"Clear selection"},s.createElement(Ae.a,{icon:"cross",minimal:!0,onClick:function(){return i("tvItemId",null)}}))},className:"select-popover-centered"})),s.createElement(Ae.j,{label:"Review",labelFor:"review"},s.createElement(Ae.C,{fill:!0,growVertically:!0,large:!0,name:"review",onChange:n,value:t.review,placeholder:"Any thoughts on what you watched?"})),s.createElement(Ae.j,{label:"Rating",labelFor:"rating"},s.createElement("div",{className:"flex flex-content-between flex-items-center"},s.createElement("div",null,s.createElement(Ut,{value:t.rating||0,className:"seen-rating",onChange:function(e){return i("rating",e)}})," ",s.createElement("span",null,t.rating||"?","/5")),t.rating&&s.createElement(Ae.a,{icon:"cross",intent:it.a.DANGER,minimal:!0,small:!0,onClick:function(){return i("rating",void 0)}}))),s.createElement(Ae.a,{type:"submit",large:!0,fill:!0,intent:it.a.PRIMARY,loading:r},"Add"))})))}function en(e){var t,n,a,r=e.editingWatched,i=e.onSubmit,l=e.isLoading,c=e.item,o=(null===r||void 0===r?void 0:r.isEditing)?{createdAt:r.item.createdAt,review:(null===(t=r.item.review)||void 0===t?void 0:t.body)||"",rating:null===(n=r.item.rating)||void 0===n?void 0:n.value,tvItemId:null===(a=r.item.tvItem)||void 0===a?void 0:a.id}:(null===r||void 0===r?void 0:r.autoTracked)?{createdAt:r.autoTracked.createdAt,tvItemId:r.autoTracked.tvItemId,review:""}:void 0;return"title"in c?u.a.createElement(Zt,{item:{id:c.id,title:c.title,poster:c.poster_path||""},values:o,onSubmit:i,isLoading:l}):"name"in c?u.a.createElement(Xt,{item:{id:c.id,title:c.name,poster:c.poster_path||"",seasons:"seasons"in c?c.seasons:void 0},values:o,onSubmit:i,isLoading:l}):null}function tn(e){var t=e.editingWatched,n=e.afterSave,i=e.item,l=re(),c=Object(Se.a)(l,2),s=c[0],d=c[1].loading,m=le({update:function(e){e.gc()}}),v=Object(Se.a)(m,2),p=v[0],f=v[1].loading,E=d||f;return u.a.createElement(en,{editingWatched:t,item:i,isLoading:E,onSubmit:function(e){var l,c,u,d,m,v,f,E;return o.a.async((function(g){for(;;)switch(g.prev=g.next){case 0:return c=e.createdAt,u=e.rating,d=e.review,m=e.tvItemId,(null===t||void 0===t?void 0:t.isEditing)&&(v=p({variables:{createdAt:c,id:t.item.id,tvItemId:m,tvItemType:m?r.Episode:void 0,rating:u?{id:null===(f=t.item.rating)||void 0===f?void 0:f.id,value:u}:void 0,review:d?{id:null===(E=t.item.review)||void 0===E?void 0:E.id,body:d}:void 0},refetchQueries:"autoTracked"in t?["AutoTrackedList"]:void 0})),v=s({variables:{createdAt:c,itemId:i.id,itemType:"name"in i?a.Tv:a.Movie,tvItemId:m,tvItemType:m?r.Episode:void 0,rating:u?{value:u}:void 0,review:d?{body:d}:void 0,autoTrackedId:t&&"autoTracked"in t?null===(l=t.autoTracked)||void 0===l?void 0:l.id:void 0},refetchQueries:["AutoTrackedList"]}),g.next=5,o.a.awrap(v);case 5:n();case 6:case"end":return g.stop()}}))}})}function nn(e){var t=e.editingWatched,n=e.item,a=e.onClose,r="name"in n?n.name:n.title;return u.a.createElement(Ae.h,{className:"fluid-dialog",title:"Seen ".concat(r),canOutsideClickClose:!1,onClose:a,isOpen:!!t,portalContainer:Rt,lazy:!0},u.a.createElement(tn,{editingWatched:t,item:n,afterSave:a}))}function an(e){e.match;var t,n=Object(s.useState)(null),a=Object(Se.a)(n,2),r=a[0],i=a[1],l=Object(f.i)().id,c=me().data,o=ge({variables:{id:l},returnPartialData:!0}).data;if(!(null===o||void 0===o?void 0:o.movie))return null;var d=o.movie,m=d.title,v=d.overview,p=d.poster_path,E=d.vote_count,g=d.vote_average,h=d.release_date,b=E>100?g:null;return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{style:{position:"relative"}},u.a.createElement("img",{width:"300",height:"200",className:"img-responsive",src:"https://image.tmdb.org/t/p/w1280".concat(p),style:{position:"relative",maxHeight:"300px",objectFit:"cover"},alt:""})),u.a.createElement("div",{className:"p-3"},u.a.createElement(Ae.k,null,m),b&&u.a.createElement(wt,{value:b}),h&&u.a.createElement("p",null,Object(jt.a)(new Date(h),"yyyy")),u.a.createElement("p",null,v),(null===c||void 0===c?void 0:c.auth)&&u.a.createElement(Ae.a,{intent:it.a.PRIMARY,large:!0,onClick:function(){return i({isEditing:!1})}},"Seen it"),(null===c||void 0===c?void 0:null===(t=c.auth)||void 0===t?void 0:t.id)&&u.a.createElement("div",null,u.a.createElement(Ae.l,null,"Your latest tracked"),u.a.createElement(Gt,{itemId:l,userId:c.auth.id,onEdit:function(e){return i({isEditing:!0,item:e})}})),u.a.createElement("div",null,u.a.createElement(Ae.l,null,"Latest reviews"),u.a.createElement(Qt,{itemId:l})),u.a.createElement(nn,{item:o.movie,editingWatched:r,onClose:function(){return i(null)}})))}var rn=Object(s.forwardRef)((function(e,t){var n=e.episode,a=n.id,r=n.episode_number,i=n.name,l=n.air_date,c=n.overview,o=n.vote_average,s=n.vote_count,d=e.tvId,m=s>1?o:null;return u.a.createElement("div",{ref:t},u.a.createElement(p.b,{to:"../"},u.a.createElement(Ae.a,{fill:!0,large:!0,icon:"chevron-left"},"Back to overview")),u.a.createElement(Ae.d,null,u.a.createElement("div",{className:"flex flex-content-between mb-3"},u.a.createElement("div",null,u.a.createElement(Ae.m,{className:"mb-0"},r," ",i),m&&u.a.createElement(wt,{value:m})),l&&u.a.createElement("div",null,Object(jt.a)(+l,"do MMM yyyy"))),u.a.createElement("p",null,c)),u.a.createElement("div",null,u.a.createElement(Ae.l,null,"Latest reviews"),u.a.createElement(Qt,{itemId:d,tvItemId:a})))}));function ln(e){var t=e.season,n=e.expanded,a=void 0!==n&&n,r=Object(s.useState)(a),i=Object(Se.a)(r,2),l=i[0],c=i[1];return u.a.createElement(Ae.d,{key:t.id,className:"mb-2"},u.a.createElement("div",{className:"flex"},u.a.createElement("img",{className:"img-responsive",style:{maxWidth:100,objectFit:"contain"},width:"300",height:"200",src:"https://image.tmdb.org/t/p/w780".concat(t.poster_path),alt:"Season ".concat(t.id," poster")}),u.a.createElement("div",{className:"w-100 pl-3"},u.a.createElement("div",{className:"mb-3 flex flex-content-between flex-items-center"},u.a.createElement(Ae.m,{className:"mb-0"},t.name),t.air_date&&u.a.createElement("div",null,Object(jt.a)(+t.air_date,"yyyy"))),u.a.createElement("p",null,t.overview))),u.a.createElement(Ae.i,{className:"my-3"}),u.a.createElement(Ae.g,{isOpen:l},u.a.createElement(Ae.m,null,"Episodes"),u.a.createElement("div",null,t.episodes.map((function(e,t){return u.a.createElement("div",{key:e.id,className:"flex mb-3"},u.a.createElement("div",{className:"pr-3 text-center",style:{width:"32px"}},u.a.createElement(Ae.B,{ellipsize:!0},e.episode_number)),u.a.createElement("div",{className:"w-100"},u.a.createElement("div",{className:"pb-2 flex flex-content-between"},u.a.createElement("div",null,u.a.createElement("strong",null,e.name)),u.a.createElement("div",{className:"pl-3"},e.air_date&&u.a.createElement(Ae.B,{ellipsize:!0},Object(jt.a)(+e.air_date,"do MMM yyyy")))),u.a.createElement("div",null,u.a.createElement("p",null,e.overview),u.a.createElement(p.b,{to:function(t){var n=t.pathname;return"".concat(n.replace(/\/$/,""),"/episode/").concat(e.id)}},u.a.createElement(Ae.a,null,"View reviews")))))})))),u.a.createElement(Ae.a,{fill:!0,minimal:!0,icon:l?"collapse-all":"expand-all",onClick:function(){return c(!l)}},l?"Collapse":"Expand"))}function cn(e){var t=e.tv,n=e.itemId,a=e.userId,r=e.onEditWatched;return u.a.createElement(u.a.Fragment,null,a&&u.a.createElement("div",null,u.a.createElement(Ae.l,null,"Your latest tracked"),u.a.createElement(Gt,{itemId:n,userId:a,onEdit:r})),u.a.createElement("div",null,u.a.createElement(Ae.l,null,"Seasons"),t.seasons.map((function(e){return u.a.createElement(ln,{key:e.id,season:e,tvId:n})}))),u.a.createElement("div",null,u.a.createElement(Ae.l,null,"Latest reviews"),u.a.createElement(Qt,{itemId:n})))}function on(e){var t,n,i,l=e.tv,c=e.editingWatched,s=e.onClose,d=re(),m=Object(Se.a)(d,2),v=m[0],p=m[1],f=le({update:function(e){e.gc()}}),E=Object(Se.a)(f,1)[0];return u.a.createElement(Ae.h,{className:"fluid-dialog",title:"Seen ".concat(l.title),canOutsideClickClose:!1,onClose:s,isOpen:!!c,lazy:!0,portalContainer:Rt},u.a.createElement(Xt,{item:l,values:(null===c||void 0===c?void 0:c.isEditing)?{createdAt:c.item.createdAt,review:(null===(t=c.item.review)||void 0===t?void 0:t.body)||"",rating:null===(n=c.item.rating)||void 0===n?void 0:n.value,tvItemId:null===(i=c.item.tvItem)||void 0===i?void 0:i.id}:(null===c||void 0===c?void 0:c.autoTracked)?{createdAt:c.autoTracked.createdAt,tvItemId:c.autoTracked.tvItemId,review:""}:void 0,isLoading:p.loading,onSubmit:function(e){var t,n,i,u,d,m,p,f;return o.a.async((function(g){for(;;)switch(g.prev=g.next){case 0:return n=e.createdAt,i=e.rating,u=e.review,d=e.tvItemId,(null===c||void 0===c?void 0:c.isEditing)&&(m=E({variables:{createdAt:n,id:c.item.id,tvItemId:d,tvItemType:d?r.Episode:void 0,rating:i?{id:null===(p=c.item.rating)||void 0===p?void 0:p.id,value:i}:void 0,review:u?{id:null===(f=c.item.review)||void 0===f?void 0:f.id,body:u}:void 0}})),m=v({variables:{createdAt:n,itemId:l.id,itemType:a.Tv,tvItemId:d,tvItemType:d?r.Episode:void 0,rating:i?{value:i}:void 0,review:u?{body:u}:void 0,autoTrackedId:c&&"autoTracked"in c?null===(t=c.autoTracked)||void 0===t?void 0:t.id:void 0}}),g.next=5,o.a.awrap(m);case 5:s();case 6:case"end":return g.stop()}}))}}))}function sn(e){var t=e.match,n=Object(s.useState)(null),a=Object(Se.a)(n,2),r=a[0],i=a[1],l=Object(f.i)().id,c=me().data,o=be({variables:{id:l}}).data;if(!(null===o||void 0===o?void 0:o.tv))return null;var d=o.tv,m=d.name,v=d.overview,p=d.first_air_date,E=d.vote_count,g=d.vote_average,h=d.poster_path,b=d.seasons,w=E>100?g:null;return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{style:{position:"relative"}},u.a.createElement("img",{width:"300",height:"200",className:"img-responsive",src:"https://image.tmdb.org/t/p/w1280".concat(h),style:{position:"relative",maxHeight:"300px",objectFit:"cover"},alt:""})),u.a.createElement("div",{className:"p-3"},u.a.createElement(Ae.k,null,m),w&&u.a.createElement(wt,{value:w}),p&&u.a.createElement("p",null,Object(jt.a)(new Date(p),"yyyy")),u.a.createElement("p",null,v),(null===c||void 0===c?void 0:c.auth)&&u.a.createElement(Ae.a,{intent:it.a.PRIMARY,large:!0,onClick:function(){return i({isEditing:!1})}},"Seen it"),u.a.createElement(f.d,null,u.a.createElement(f.b,{path:"".concat(t.path,"/episode/:episodeId"),render:function(e){var t=e.match,n=function(e,t){for(var n=0;n<e.length;n=1){var a=e[n].episodes.find((function(e){return e.id===t}));if(a)return a}}(b,t.params.episodeId);return n?n&&u.a.createElement(rn,{tvId:l,episode:n}):null}}),u.a.createElement(f.b,{path:"".concat(t.path),render:function(e){var t;e.match;return u.a.createElement(cn,{tv:o.tv,userId:null===c||void 0===c?void 0:null===(t=c.auth)||void 0===t?void 0:t.id,itemId:l,onEditWatched:function(e){return i({isEditing:!0,item:e})}})}})),u.a.createElement(on,{tv:{id:o.tv.id,title:m,poster:o.tv.poster_path||"",seasons:b},editingWatched:r,onClose:function(){return i(null)}})))}var un=n(128),dn=new RegExp("^(?:(?:(?:https?|ftp|\\*):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:\\*\\.?)?(?:[a-z0-9\\u00a1-\\uffff][a-z0-9\\u00a1-\\uffff_-]{0,62})?[a-z0-9\\u00a1-\\uffff]\\.)+((?:\\*)|(?:[a-z\\u00a1-\\uffff]{2,}\\.?)))(?::\\d{2,5})?(?:[/?#]\\S*)?$","i");function mn(e,t,n,a,r,i){if(e&&dn.test(e))if(i)r("This address is already covered.");else{var l="^".concat(e.replace(/[.+?^${}()/|[\]\\]/g,"\\$&").replace(/\*/g,".*").toLowerCase());t.includes(l)?r("This address is already in the list."):(a([].concat(Object(Je.a)(t),[l])),n(""))}else r("Invalid address")}var vn=function(e){var t=e.id,n=e.list,a=e.updateList,r=e.helperTextPrefix,i=s.useState(""),l=Object(Se.a)(i,2),c=l[0],o=l[1],u=s.useState(""),d=Object(Se.a)(u,2),m=d[0],v=d[1],p=n.reduce((function(e,t){var n=!!c&&new RegExp(t,"i").test(c);return e.hasClashing=e.hasClashing||!!n,e.list.push({matches:n,display:t.replace(/\^|\.(\*)|\\/g,"$1")}),e}),{list:[],hasClashing:!1}),f=p.list,E=p.hasClashing;return s.createElement(s.Fragment,null,s.createElement(Ae.j,{label:"Blacklisted sites",labelFor:"blacklist-input",helperText:s.createElement(s.Fragment,null,r,s.createElement("span",null,"Supports basic wildcards, some supported examples:",s.createElement("br",null),"https://www.netflix.com/watch/80186674",s.createElement("br",null),"*://*.google.com/video/*",s.createElement("br",null),"//youtube.*",s.createElement("br",null),"*://watch.*"))},s.createElement(Ae.p,{id:t,value:c,intent:m?it.a.DANGER:it.a.NONE,placeholder:"https://netflix.com/*",onChange:function(e){var t=e.currentTarget;o(t.value),v("")},onKeyPress:function(e){return"Enter"===e.key?mn(e.target.value,n,o,a,v,E):null},rightElement:s.createElement(Ae.a,{onClick:function(){return mn(c,n,o,a,v,E)},icon:"add",minimal:!0})}),m?s.createElement(Ae.c,{intent:it.a.DANGER},m):null),s.createElement("ul",null,f.map((function(e,t){return s.createElement("li",{key:e.display,style:{color:e.matches?un.a.RED1:"inherit"}},e.display,s.createElement(Ae.a,{icon:"delete",intent:e.matches?it.a.DANGER:it.a.NONE,minimal:!0,onClick:function(){return a(n.filter((function(e){return e!==n[t]})))}}))}))))};function pn(){var e,t=(e={pollInterval:6e4,fetchPolicy:"network-only"},v.useQuery(Ce,e)),n=t.data,a=t.loading,r=me().data,i=null===n||void 0===n?void 0:n.settings,l=function(e){return v.useMutation(ue,e)}({update:function(e,t){var n=t.data;n&&function(e,t){ct("userData",t),e.writeQuery({query:Ce,data:{settings:t.settings}})}(e,Object(rt.a)({},null===r||void 0===r?void 0:r.auth,{settings:n.updateSettings}))}}),c=Object(Se.a)(l,1)[0],o=a||!i?null:{general:{autoConvert:i.general.autoConvert},extension:{autoTrack:i.extension.autoTrack,minLengthSeconds:i.extension.minLengthSeconds,blacklist:i.extension.blacklist}};return u.a.createElement(u.a.Fragment,null,u.a.createElement(Ae.k,null,"Settings"),u.a.createElement("p",{className:"mb-4"},"Set your preferences for browser extension, desktop app and control how tracking works"),o?u.a.createElement(Vt.b,{onSubmit:function(e){return c({variables:e})},enableReinitialize:!0,initialValues:o},(function(e){var t=e.values,n=e.handleChange,a=e.setFieldValue,r=e.isSubmitting;return u.a.createElement(Vt.a,null,u.a.createElement("div",null,u.a.createElement(Ae.l,{className:"mt-4"},"General"),u.a.createElement("p",{className:"mb-4"},"Site specific settings"),u.a.createElement(Ae.j,{label:"Auto tracked",helperText:"Enabling this publishes identified auto tracked items directly to your watched list instead of saving them as a draft first"},u.a.createElement(Ae.A,{name:"general.autoConvert",label:"Automatically publish eligible items",checked:t.general.autoConvert,onChange:n}))),u.a.createElement("div",null,u.a.createElement(Ae.l,{className:"mt-4"},"Extension"),u.a.createElement("p",{className:"mb-4"},"Controls the browser extension behavior"),u.a.createElement(Ae.j,{label:"Tracking",helperText:"Enabling this removes the watched popup after finishing a video and instead automatically saves the item as a draft"},u.a.createElement(Ae.A,{name:"extension.autoTrack",label:"Automatically track finished videos",checked:t.extension.autoTrack,onChange:n})),u.a.createElement(Ae.j,{label:"Minimum video length",helperText:"Specify minimum amount in seconds for videos to be registered as watched"},u.a.createElement(Ae.v,{onValueChange:function(e){return a("extension.minLengthSeconds",e)},value:t.extension.minLengthSeconds})),u.a.createElement(vn,{list:t.extension.blacklist,updateList:function(e){return a("extension.blacklist",e)},helperTextPrefix:u.a.createElement("p",null,"List of domains that are not tracked")})),u.a.createElement(Ae.a,{type:"submit",loading:r},"Save"))})):u.a.createElement(Ae.z,{size:16}))}function fn(){return u.a.createElement(Ae.u,{icon:"map",className:"p-5",title:"Uh oh",description:"Page not found. You sure the link is correct?",action:u.a.createElement(p.b,{to:"/"},u.a.createElement(Ae.a,null,"Go to homepage"))})}function En(e){var t=e.children;return u.a.createElement("div",{className:"p-4"},t)}function gn(e){var t=e.item,n=e.editingWatched,r=e.onClose,i=Object(s.useState)(),l=Object(Se.a)(i,2),c=l[0],o=l[1],d={id:null===c||void 0===c?void 0:c.id},m=be({variables:d,skip:(null===c||void 0===c?void 0:c.type)!==a.Tv}),v=ge({variables:d,skip:(null===c||void 0===c?void 0:c.type)!==a.Movie}),p=(null===c||void 0===c?void 0:c.type)===a.Movie?v:m,f=p.data,E=p.loading,g=f?"tv"in f?f.tv:f.movie:void 0,h=t||g,b=t?"Seen ".concat("name"in t?t.name:t.title):"Find auto tracked",w=n&&!n.isEditing&&n.autoTracked?n.autoTracked.meta:void 0;return u.a.createElement(Ae.h,{className:"fluid-dialog",title:b,canOutsideClickClose:!1,isOpen:!!n,lazy:!0,onClose:r,portalContainer:Rt},!t&&n&&"autoTracked"in n&&n.autoTracked&&u.a.createElement("div",{className:"p-3"},u.a.createElement("p",null,"Seen ",u.a.createElement(Ct,{date:n.autoTracked.createdAt})),u.a.createElement("strong",null,"Here's what we know:"),w&&w.title&&u.a.createElement("p",{className:"mb-1"},u.a.createElement("span",null,"Title read as "),u.a.createElement(Ae.f,null,w.title)),w&&w.tvData&&u.a.createElement("div",{className:"mb-1"},u.a.createElement("span",null,"TV info - "),w.tvData.season&&u.a.createElement("span",null,"S",w.tvData.season),w.tvData.episode&&u.a.createElement("span",null,"E",w.tvData.episode)),w&&w.provider&&u.a.createElement("div",{className:"mb-1"},u.a.createElement("span",null,"Tracked on ",w.provider,", from"),u.a.createElement("br",null),w.url&&u.a.createElement(Ae.f,{className:"mt-1",style:{display:"inline-block",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"320px",overflow:"hidden"}},w.url),w.filename&&u.a.createElement(Ae.f,{className:"mt-1",style:{display:"inline-block",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"320px",overflow:"hidden"}},w.filename)),u.a.createElement(tt,{selected:c,setSelected:o})),E&&u.a.createElement(Ae.z,null),h&&!E&&u.a.createElement(tn,{item:h,editingWatched:n,afterSave:r}))}var hn=function(e){var t=Object(f.g)();return u.a.createElement(gn,Object.assign({},e,{onClose:function(){var e=new URLSearchParams(t.location.search);e.delete(St.EditingAutoTracked),t.replace("".concat(t.location.pathname,"?").concat(e))}}))},bn=function(e){var t=Object(f.g)();return u.a.createElement(nn,Object.assign({},e,{onClose:function(){var e=new URLSearchParams(t.location.search);e.delete(St.EditingWatched),t.replace("".concat(t.location.pathname,"?").concat(e))}}))};function wn(){var e,t=new URLSearchParams(Object(f.h)().search),n=t.get(St.EditingAutoTracked),a=t.get(St.EditingWatched),r=(e={variables:{id:n||""},skip:!n},v.useQuery(xe,e)).data,i=function(e){return v.useQuery(we,e)}({variables:{id:a||""},skip:!a}).data;if(n&&r){var l,c=r.autoTracked;return u.a.createElement(hn,{item:c.item,editingWatched:{isEditing:!1,autoTracked:{id:c.id,createdAt:c.createdAt,meta:c.meta,tvItemId:null===(l=c.tvItem)||void 0===l?void 0:l.id}}})}if(a&&i){var o=i.watched;return u.a.createElement(bn,{editingWatched:{isEditing:!0,item:o},item:o.item})}return null}function yn(){return u.a.createElement(u.a.Fragment,null,u.a.createElement(at,null),u.a.createElement("div",null,u.a.createElement(f.d,null,u.a.createElement(Ne,{exact:!0,path:"/",component:Pt,redirectComponent:ft}),u.a.createElement(f.b,{path:"/movie/:id",component:an}),u.a.createElement(f.b,{path:"/tv/:id",component:sn}),u.a.createElement(f.b,{exact:!0,path:"/profile/:name",component:Tt}),u.a.createElement(En,null,u.a.createElement(f.d,null,u.a.createElement(f.b,{exact:!0,path:"/setup",component:kt}),u.a.createElement(f.b,{exact:!0,path:"/login",component:ut}),u.a.createElement(Ne,{exact:!0,path:"/settings",component:pn}),u.a.createElement(f.b,{path:"*",component:fn})))),u.a.createElement(wn,null)))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var In=n(144),On=n(142),Tn=n(143);function kn(){var e=Object(g.a)(["\n  extend type Query {\n    auth: User\n    isExtensionCheckDone: Boolean\n  }\n"]);return kn=function(){return e},e}var xn=Object(v.gql)(kn()),jn={Mutation:{logout:function(e,t,n){var a=n.cache;n.client;st(a);var r={ROOT_QUERY:{isExtensionCheckDone:a.extract().ROOT_QUERY.isExtensionCheckDone}};a.restore(r)}}},Cn={possibleTypes:{Item:["Movie","Tv"],TvItem:["Season","Episode"],AutoTrackedResult:["AutoTracked","Watched"],TmdbMedia:["TmdbMovie","TmdbTv"]}},Nn={WatchedCursor:{fields:{watched:{read:function(e,t){var n=t.readField;return e.filter((function(e){return!!n("id",e)}))}}}},Query:{fields:{autoTracked:function(e,t){var n=t.args;return(0,t.toReference)({__typename:"AutoTracked",id:null===n||void 0===n?void 0:n.id})}}}},Sn=new Promise((function(e,t){document.addEventListener("seenit-extension-sync",(function(){return e(!0)})),setTimeout((function(){return t("timeout")}),5e3)})).catch((function(){return!1})),An=new Promise((function(e,t){try{chrome.runtime.sendMessage("fobdnlhhghamfijjkfjjpfjaeffkelgk","ping",(function(n){return chrome.runtime.lastError?t(chrome.runtime.lastError):"pong"===n?e(!0):void 0}))}catch(n){t(n)}})).then((function(){return Sn})).catch((function(){return!1}));An.then((function(e){Rn.writeQuery({query:de,data:{auth:lt("userData")||null}}),Rn.writeQuery({query:ve,data:{isExtensionCheckDone:!0}})}));var $n=Object(On.a)((function(e){var t=e.graphQLErrors;e.networkError;(null===t||void 0===t?void 0:t.some((function(e){var t=e.extensions;return"UNAUTHENTICATED"===(void 0===t?{}:t).code})))&&st(Rn)})),Rn=new v.InMemoryCache({possibleTypes:Cn.possibleTypes,typePolicies:Nn}),Dn=new In.a({uri:"http://localhost:9000/graphql"}),Ln=Object(Tn.a)((function(e){var t;return o.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.awrap(An);case 2:return t=lt("token"),e.abrupt("return",{headers:{authorization:t?"Bearer ".concat(t):""}});case 4:case"end":return e.stop()}}))})),_n=new v.ApolloClient({cache:Rn,resolvers:jn,link:v.ApolloLink.from([$n,Ln,Dn]),typeDefs:xn}),Mn=function(e){var t,n=e.children,a=v.useQuery(ve,t).data;return(null===a||void 0===a?void 0:a.isExtensionCheckDone)?u.a.createElement(u.a.Fragment,null,n):null};o.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:m.a.render(u.a.createElement(v.ApolloProvider,{client:_n},u.a.createElement(p.a,null,u.a.createElement(Mn,null,u.a.createElement(yn,null)))),Rt||null);case 1:case"end":return e.stop()}})),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[180,1,2]]]);
//# sourceMappingURL=main.38481d62.chunk.js.map